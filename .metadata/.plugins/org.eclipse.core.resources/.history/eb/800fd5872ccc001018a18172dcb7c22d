<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
    <%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
<div class="breadcrumb_conatiner">
            <div class="col-md-6">
                <h4  class="change-color">View Applied Status</h4>
            </div>
            <div class="col-md-6">
<%--             <%@ include file="/WEB-INF/views/message.jsp"%> --%>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb"> 
                    <li class="breadcrumb-item"><a href="${contextPath}/home"><i class="fa fa-home"></i></a></li>
                    <li class="breadcrumb-item active" aria-current="page">View Applied Status</li>
                </ol>
            </nav>
            </div>
        </div>
		<div class="row">
			    <div class="col-md-12">
			        <div class="card">
			            <div class="card-header">
			                <h5 class="card-title">View Applied Status</h5>
			            </div>
			            <div class="card-body">
			                <div class="row">
			                    <form action="${contextPath}/vaccancy/viewAppliedStatus" method="post" id="viewAppliedStatus" class="row" enctype="multipart/form-data">
			                        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
			                        <div class="col-md-6">
			                            <label for="registrationNumber">Enter Your Registration Number</label>
			                            <input type="text" class="form-control" id="registrationNumber" name="registrationNumber" placeholder="Enter Registration Number" required>
			                        </div>
			                        <div class="col-md-6 d-flex align-items-end">
			                            <button class="btn btn-primary" id="searchButton" type="button" onclick="validateAndProceed()">Search</button>
			                        </div>
			                    </form>
			                </div>
			                <hr>
			                <!-- Table for displaying results -->
			                <div class="table-responsive">
			                    <table class="table table-bordered">
			                        <thead>
			                            <tr>
			                                <th>Applicant Name</th>
			                                <th>Registration code</th>
			                                <th>Mobile No</th>
			                                <th>Email</th>
			                                <th>Aadhaar No</th>
			                                <th>DOB</th>
			                                <th>Age</th>
			                                <th>Status</th>
			                            </tr>
			                        </thead>
			                        <tbody>
			                                <tr>
			                                    <td>${details[0][0]}</td>
			                                    <td>${details[0][1]}</td>
			                                    <td>${details[0][2]}</td>
			                                    <td>${details[0][3]}</td>
			                                    <td>${details[0][4]}</td>
			                                    <td>${details[0][5]}</td>
			                                    <td>${details[0][6]}</td>
			                                    <td>${details[0][7]}</td>
			                                </tr>
			                        </tbody>
			                    </table>
			                </div>
			            </div>
			        </div>
			    </div>
			</div>


 
</body>
</html>
<script>
//     function searchRegistration() {
//         var registrationNumber = document.getElementById('registrationNumber').value;
//         if (registrationNumber.trim() === "") {
//             alert("Registration number is mandatory!");
//             return false;
//         } else {
//             $("#viewAppliedStatus").submit();
//         }
//     }
    function validateAndProceed() {
	    const registrationNumber = document.getElementById("registrationNumber").value.trim();
	    const errorText = document.getElementById("errorText");
	
	    if (!registrationNumber) {
	        bootbox.alert("Please enter your regisytration number.");
	    } else {
	        checkRegdNum(registrationNumber); // Call the function with the vacancy ID
	    }
    }
    function checkRegdNum(registrationNumber){
    	debugger
    	 $.ajax({
    	        url: "${contextPath}/vaccancy/checkRegistrationNumber",
    	        type: "GET",
    	        data: {
    	            "registrationNumber": registrationNumber,
    	        },

    	        success: function (response) {
    	            if (response == '') {
    	                bootbox.alert("Invalid registration number.");
    	                $("#registrationNumber").val('');
    	                return false;
    	            } else {
    	            	$("#viewAppliedStatus").submit();
    	            }
    	        }
    	    });
    }
</script>