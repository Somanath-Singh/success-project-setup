
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<script src="${contextPath}/assets/appJs/validation/common-utils.js"></script>
<div class="content">
	<div class="breadcrumb_conatiner">
		<div class="col-md-6"> 
			<h4 class="change-color">Add & Manage Fund Type</h4>
		</div>
		<div class="col-md-6">
			<nav aria-label="breadcrumb">
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="${contextPath}/home"><i class="fa fa-home"></i></a></li>
					<li class="breadcrumb-item active" aria-current="page">Manage Fund Type</li>
				</ol>
			</nav>
		</div>
	</div>
	<div class="page-inner">
		<div class="row mt-2">

			<div class="col-md-12">
				<div class="card full-height">
					<div class="card-header">
						<c:choose>
							<c:when test="${not empty fundType.fundTypeId}">
								<h4 class="card-title">Update Fund Type</h4>
							</c:when>
							<c:otherwise>
								<h4 class="card-title">Add Fund Type</h4>
							</c:otherwise>
						</c:choose>
					</div>
					<div class="card-body">
						<div class="row">
							<form action="${contextPath}/admin/master/fundType/save" id="addFundTypeFrm"
								method="post">
								<input type="hidden" name="${_csrf.parameterName}"
									value="${_csrf.token}" /> <input type="hidden" name="fundTypeId"
									value="${fundType.fundTypeId}" id="fundTypeId" />
								<div class="col-md-12 row">
									<div class="col-md-3">
										<div class="form-group">
											<label class="col-md-12 required" for="fundTypeName">Fund Type Name :</label>
											<div class="col-md-12">
												<input type="text" class="form-control form-control-sm AlphaNumericOnly" id="fundTypeName" name="fundTypeName" value="${fundType.fundTypeName}" required="required" maxlength="20">
											</div>
										</div>
									</div>									
								    <div class="col-md-3">
                                        <div class="form-group">
                                            <label class="col-md-12" for="fundTypeName">Fund Type Code :</label>
                                            <div class="col-md-12">
                                                <input type="text" class="form-control form-control-sm AlphaNumericOnly" id="" name="" value="${fundType.fundTypeCode}" readonly>
                                            </div>
                                        </div>
                                    </div>
									<div class="text-center" style="margin-top: 20px;">
										<c:choose>
											<c:when test="${not empty fundType}">
												<input type="button" name="add&ManageApplicationScheme"
													value="Update" id="add&ManageApplicationSchemes"
													class="btn btn-success btn-sm" onclick="submitFormData()">&nbsp;&nbsp;
														<a href="${contextPath}/admin/master/fundType/list" type="button"
													class="btn btn-warning btn-sm">Back</a>
											</c:when>
											<c:otherwise>
												<input type="button" name="add&ManageApplicationScheme"
													value="Submit" id="add&ManageApplicationSchemes"
													class="btn btn-success btn-sm" onclick="submitFormData()">
													
														<a  type="button" class="btn btn-warning btn-sm" onclick="backToModule()">Back</a>
											</c:otherwise>
										</c:choose>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>

		</div>
		<div class="row mt-3">
			<div class="col-md-12">
				<div class="card full-height">
					<div class="card-header">
						<h4 class="card-title">FundType List</h4>
					</div>
					<div class="card-body">
						<div class="table-responsive">
							<table id="basic-datatables"
								class="display table table-bordered table-hover  exportbtn">
								<thead>
									<tr>
										<th class="text-center" style="max-width:50px;">Sl.No.</th>
										<th>Fund Type Name</th>
										<th>Fund Type Code</th>
										<th>Status</th>
										<th style="max-width:80px;">Action</th>
									</tr>
								</thead>
								<tbody id="tbd">
									<c:forEach items="${lstFundType}" var="fundType" varStatus="count">
										<tr>
											<td class="text-center">${count.count}</td>
											<td>${fundType.fundTypeName}</td>
											<td>${fundType.fundTypeCode}</td>
											<c:if test="${fundType.isActive eq true }">
												<td>Active</td>
											</c:if>
											<c:if test="${fundType.isActive eq false }">
												<td>InActive</td>
											</c:if>
											<td >
											<c:if test="${fundType.isActive eq true}">
											<button class="btn btn-warning btn-sm"
													onclick="editFundTypeById('${fundType.fundTypeId}')" title="Edit Fund Type ">
													<i class="fas fa-edit"></i>
												</button>
												<button class="btn btn-danger btn-sm"
														onclick="activeInactiveFundType('INACTIVE', '${fundType.fundTypeId}')"
														title="Deactivate Fund Type ">
														<i class="fa fa-lock" aria-hidden="true"></i>
													</button>
											</c:if>
											 <c:if test="${fundType.isActive eq false}">
													<button class="btn btn-success btn-sm"
															onclick="activeInactiveFundType('ACTIVE', '${fundType.fundTypeId}')"
															title="Activate Fund Type ">
													<i class="fa fa-unlock-alt" aria-hidden="true"></i>
																	</button>
																</c:if>
												
											</td>
										</tr>
									</c:forEach>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<form method="GET" id="formId"></form>
<form action="${contextPath}/admin/master/fundType/changefundTypeStatus.htm"
	id="changefundTypeStatus" method="post">
	<input type="hidden" name="${_csrf.parameterName}"
		value="${_csrf.token}" /> <input type="hidden" name="actionType"
		id="actionType" /> <input type="hidden" name="fundId" id="fundId" />
</form>
<script>
function editFundTypeById(id) {
	$("#formId").attr('action',
			'${contextPath}/admin/master/fundType/edit/' + id + '');
	$("#formId").submit();
}
	
	function submitFormData(){	
		if($("#fundTypeName").val()==""){
			bootbox.alert("Please enter Fund Type Name");
			return false;
		}

		else{	
			var flag = window.confirm("Do you want to continue ?");
	  		if (flag == true) {
	  			
	  			$("#addFundTypeFrm").submit();

	  		}else{
	  			
	  			//e.preventDefault();
	  		} 
					
//$("#addFundTypeFrm").submit();
		}
									
	}
	function activeInactiveFundType(actionType, fundTypeId) {
		$("#actionType").val(actionType); 
		$("#fundId").val(fundTypeId); 
		if(actionType == 'INACTIVE') {
			bootbox.confirm({
			    message: "Do you want to deactivate the Fund Type?",
			    buttons: {
			        confirm: {
			            label: 'Yes',
			            className: 'btn-success'
			        },
			        cancel: {
			            label: 'No',
			            className: 'btn-danger'
			        }
			    },
			    callback: function (result) {
			    	if(result == true) {
			    		$("#changefundTypeStatus").submit();  
			    	} 
			    }
			}); 
		}
		if(actionType == 'ACTIVE') {
			bootbox.confirm({
			    message: "Do you want to activate the Fund Type?",
			    buttons: {
			        confirm: {
			            label: 'Yes',
			            className: 'btn-success'
			        },
			        cancel: {
			            label: 'No',
			            className: 'btn-danger'
			        }
			    },
			    callback: function (result) {
			    	if(result == true) {
			    		$("#changefundTypeStatus").submit();  
			    	} 
			    }
			}); 
		}
	}
	
	
	// $('#fundTypeName').keypress(function (e) {
    //     var regex = new RegExp(/^[a-zA-Z0\s]+$/);
    //     var str = String.fromCharCode(!e.charCode ? e.which : e.charCode);
    //     if (regex.test(str)) {
    //         return true;
    //     }
    //     else
    //     {
    //     e.preventDefault();
    //    bootbox.alert('Special Chataters are not allowed');
    //     return false;
    //     }
    // });
	
	</script>
