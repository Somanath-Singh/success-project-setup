<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix = "fn" uri = "http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib uri = "http://java.sun.com/jsp/jstl/functions" prefix = "fn" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<script src="${contextPath}/assets/appJs/validation/common-utils.js"></script>
<sec:authentication var="principal" property="principal" />
<c:set var="roleCode" value="${principal.primaryRole.roleCode}"/>

<div class="breadcrumb_conatiner">
               <div class="col-md-6">
                 <h4 class="change-color">Amenities</h4>
               </div>
              <div class="col-md-6">
                <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="${contextPath}/home"><i class="fa fa-home"></i></a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">Add Amenities</li>
                </ol>
                </nav>
              </div>
            </div>
            

    
    
       
<div class="card">
    
    <div class="card-header"><h5 class="card-title">Add Amenities</h5></div>
    <div class="card-body">
    <form action="${contextPath}/facility/saveMstAmenities" method="post" id="saveAmenitiesId" class="row">
    	<input type="hidden" id="cipherText" name="cipherText">
        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
        <input type="hidden" name="facilityAmenitesId" value="${facilityAmenities.aminitiesId}">
        <div class="form-group col-md-2">
            <label class="required">Amenities Name</label>
            <input type="text" class="form-control form-control-sm" id="amenitiesNameId" name="amenitiesName" maxlength="20" value="${facilityAmenities.name}">
        </div>
        
        <div class="form-group col-md-2">
            <label class="required">Description</label>
            <input type="text" class="form-control form-control-sm" id="descriptionId" name="description" maxLength="30" value="${facilityAmenities.description}">
        </div>
        
        <div class="form-group col-md-4 text-left" style="margin-top: 19px;">
            <button type="button" class="btn btn-submit searchdiv" style="margin-left: 8px;" onclick="submitForm('${empty facilityAmenities.aminitiesId ? 'SAVE' : 'UPDATE'}')" >${empty facilityAmenities.aminitiesId ? 'Submit' : 'Update'}</button>
            <button type="button" class="btn btn-warning searchdiv" style="margin-left: 8px;" onclick="history.back()">Back</button>
        </div>
    </form>
</div>
</div>


<div class="card cardContainerNotFirst mt-3">
 <div class="card-header"><h5 class="card-title">Amenities List</h5></div>
	 <div class="card-body">
		<div class="col-md-12 table-responsive">
		<table class="datatable table table-striped table-bordered exportbtn">
	    	<thead>
		        <tr>
		            <th class="text-center" style="width: 60px;">Sl. No</th>
		            <th>Amenities Name</th>
		            <th>Description</th>
		            <th>Action</th>
		        </tr>
	    	</thead>
	    	<tbody>
		        <c:forEach items="${facilityAmenitiesList}" var="facility" varStatus="count">
		            <tr>
		                <td class="text-center">${count.count}</td>
		                <td>${facility.name}</td>
		                <td>${facility.description}</td>
		                <td style="width: 60px;">
						 <button type="button" onclick="editAmenitiesData('${facility.aminitiesId}');" title="Edit" class="btn btn-primary">
								 <i class=" fa fa-pencil " aria-hidden="true"></i></button>
					    </td>
		            </tr>
		        </c:forEach>
	    	</tbody>
		</table>
		</div>
	</div>
</div>

<form action="${contextPath}/facility/editMstAmenities" method="get" id="editAmenitiesId">
<input type="hidden" name="amntId" id="amenitiesIdId">
<input type="hidden" id="editCipherText" name="cipherText">
<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
</form>

<script>
function submitForm(status) {
    if ($("#amenitiesNameId").val().trim() == "") {
        bootbox.alert("Please provide amenities name.");
        $("#amenitiesNameId").val('');
        return false;
    } else if ($("#descriptionId").val().trim() == "") {
        bootbox.alert("Please provide description.");
        $("#descriptionId").val('');
        return false;
    }else { var message = status === 'SAVE' ? 'save' : 'update';
    var bizContent = $("#saveAmenitiesId").serializeArray();
	$("#cipherText").val(enc_password(JSON.stringify(convertFormToJSONArray(bizContent))));
	 bootbox.confirm("Do you want to "+message+" facility details ?", function (result) {
            if (result) {
                showLoader();
                $("#saveAmenitiesId").submit();
            }
        });
    }
}

function editAmenitiesData(id) {
	$("#amenitiesIdId").val(id);
	showLoader();
	var bizContent = $("#editAmenitiesId").serializeArray();
	$("#editCipherText").val(enc_password(JSON.stringify(convertFormToJSONArray(bizContent))));
    $("#editAmenitiesId").submit();
}

</script>


