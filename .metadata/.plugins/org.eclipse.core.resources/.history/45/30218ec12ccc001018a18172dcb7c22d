<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles"%>
<%@ page language="java" pageEncoding="utf-8"
	contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<%--<jsp:useBean id="strUtils" class="com.aashdit.demography.utils.ApplicationStringUtils"/>--%>
		<div class="breadcrumb_conatiner">
			<div class="col-md-6">
				<h4 class="change-color">Manage Budget</h4>
			</div>
			<div class="col-md-6">
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="#">Home</a></li>
						<li class="breadcrumb-item active" aria-current="page">Manage Budget</li>
					</ol>
				</nav>
			</div>
		</div>


			
				
				
					<div class="row mt--2">	
						<div class="col-md-12">
							<div class="card full-height">
								<div class="card-header">
									<h4 class="card-title"> Budget Requested List</h4>
									<div class="panel-actions">
										<a href="#" class="fa fa-caret-down"></a>
									</div>
								</div>
								<div class="card-body" style="">

									<div class="col-md-12" id="tabs">
										<ul class="nav nav-pills">
											<li class="nav-item" >
												<a class="nav-link active" data-bs-toggle="tab" href="#pending" id="a">Pending</a>
											</li>
											<li class="nav-item" >
												<a class="nav-link" data-bs-toggle="tab" href="#approved" id="b">Approved</a>
											</li>
											<li class="nav-item" >
												<a class="nav-link" data-bs-toggle="tab" href="#reject" id="c">Reverted</a>
											</li>
										</ul>

										<!-- Tab panes -->
										<div class="tab-content">
											<div class="tab-pane" id="pending">
												<div class="col-md-12">
													<table class="table table-bordered DataTable mt-4 mb-4 text-center" >
														<thead>
															 <tr>
                                                            <th style="width: 55px;">Sl No.</th>
                                                            <th>Financial Year</th>
                                                            <th>Budget Creation Date </th>
                                                            <th>Fund Type </th>
                                                            <th>Amount</th>
                                                            <th>Current Stage</th>
                                                            <th>Action</th>
                                                        </tr>
														</thead>
														<tbody>
														 <c:forEach items="${budPendingList}" var="budPending" varStatus="count">
														     <tr>
																<td>${count.count}</td>
	                                                            <td>${budPending.finyear.finYearr}</td>
	                                                            <td>${budPending.transDate}</td>
	                                                            <td>${budPending.fundType.fundTypeName}</td>
	                                                            <td class="text-right">${budPending.amount}</td>
																<td>${budPending.stageForwardedRule.toStageMaster.stageNameEn}</td>
																<td>
																   <a href="#" onclick="viewBudgetDtlsById(${budPending.budgetId})" class="btn btn-success btn-sm" title="View"><i class="fas fa-eye"></i></a>
																</td>
															</tr>
														</c:forEach>
														</tbody>
													</table>
												</div>
											</div>
											<div class="tab-pane fade" id="approved">
												<table class="table table-bordered DataTable mt-4 mb-4 text-center" >
															<thead>
															<tr>
                                                            <th style="width: 55px;">Sl No.</th>
                                                            <th>Financial Year</th>
                                                            <th>Budget Creation Date </th>
                                                            <th>Fund Type </th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                            </tr>
														   </thead>
														<tbody>
														 <c:forEach items="${budApprovedList}" var="budApproved" varStatus="count">
														     <tr>
																<td>${count.count}</td>
	                                                            <td>${budApproved.finyear.finYearr}</td>
	                                                            <td>${budApproved.transDate}</td>
	                                                            <td>${budApproved.fundType.fundTypeName}</td>
	                                                            <td class="text-right">${budApproved.amount}</td>
																<td>
															   <a href="#" onclick="viewBudgetDtlsById(${budApproved.budgetId})" class="btn btn-success btn-sm" title="View"><i class="fas fa-eye"></i></a>
																</td>
															</tr>
														</c:forEach>
														</tbody>
													</table>
											</div>
											<div class="tab-pane fade" id="reject">
												<table class="table table-bordered DataTable mt-4 mb-4 text-center" >
														<thead>
															<tr>
                                                            <th style="width: 55px;">Sl No.</th>
                                                            <th>Financial Year</th>
                                                            <th>Budget Creation Date </th>
                                                            <th>Fund Type </th>
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                           </tr>
														</thead>
														<tbody>
														 <c:forEach items="${budRejectedList}" var="budRejected" varStatus="count">
														     <tr>
																<td>${count.count}</td>
	                                                            <td>${budRejected.finyear.finYearr}</td>
	                                                            <td>${budRejected.transDate}</td>
	                                                            <td>${budRejected.fundType.fundTypeName}</td>
	                                                            <td class="text-right">${budRejected.amount}</td>
																<td>
																   <a href="#" onclick="viewBudgetDtlsById(${budRejected.budgetId})" class="btn btn-success btn-sm" title="View"><i class="fas fa-eye"></i></a>
																</td>
															</tr>
														</c:forEach>
														</tbody>
													</table>
											</div>
										</div>
										
									</div>
								</div>
							</div>
						</div>
					</div>

<form method="GET" id="formId">
 <input type="hidden" name="tabCode" id="tabCode" value="${tabCode}">
 <input type="hidden" name="viewType" id="viewType" value="REQUESTED_BDG">
</form>
<script >
	function viewBudgetDtlsById(budgetId){
		$("#formId").attr('action','${contextPath}/bdg/budget/view/'+ budgetId +'');
	    $("#formId").submit();
	}
	function editBudgetDtlsById(budgetId){
		$("#formId").attr('action','${contextPath}/bdg/budget/edit/'+ budgetId +'');
	    $("#formId").submit();
	}
	
	
	$(document).ready(function() {
	     if('${tabCode}'=='TAB1'){
	    	$("#pending").addClass("in active");
	    	$("#a").addClass("active");
	    	
	    }else if('${tabCode}'=='TAB2'){
	    	$("#approved").addClass("active show");
	    	$("#b").addClass("active");
	    	
	    }else if('${tabCode}'=='TAB3'){
	    	$("#reject").addClass("active show");
	    	$("#c").addClass("active");
	    	
	    }else{
	    	$("#pending").addClass("in active");
	        $("#a").addClass("active");
	    }
	    
	});
	
	$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		  var target = $(e.target).attr("href") // activated tab
		  if(target=="#pending"){
			  $("#tabCode").val("TAB1");
		  }else if(target=="#approved"){
			  $("#tabCode").val("TAB2");  
		  }else if(target=="#reject"){
			  $("#tabCode").val("TAB3");  
		  }
		});
	</script>	
				