<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
    <%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<style>
.student_detailsTable table{
	width: 100%;
 & tr td{
	padding: 10px 0;
}
}
th {
    color: #0f0e47;
    font-weight: 600 !important;
    letter-spacing: 0.5px;
}
tr{
    vertical-align: baseline;
}
</style>
</head>
<body>
<div class="breadcrumb_conatiner">
            <div class="col-md-6">
                <h4  class="change-color">Candidate Details</h4>
            </div>
            <div class="col-md-6">
            <h3>${regd_message}</h3>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb"> 
                    <li class="breadcrumb-item"><a href="${contextPath}/home"><i class="fa fa-home"></i></a></li>
                    <li class="breadcrumb-item active" aria-current="page">Candidate Details</li>
                </ol>
            </nav>
            </div>
        </div>
<div class="row">
     <div class="col-md-12">
         <div class="card">
             <div class="card-header">
                 <h5 class="card-title">Candidate Details</h5>
             </div>
             <div class="card-body">
                 <div class="row student_detailsTable">
                 	<div class="col-md-12 text-center"></div>
                     <div class="col-md-4">
		                <table style="" class="">
						    <tbody>
						        <tr>
						            <th style="width: 40%">Applicant Name</th>
						            <td style="width: 10%">:</td>
						            <td style="width: 50%">${allDetails.name}</td>
						        </tr>
						        <tr>
						            <th>Registration Code</th>
						            <td>:</td>
						            <td>${allDetails.code}</td>
						        </tr>
						        <tr>
						            <th>Mobile No.</th>
						            <td>:</td>
						            <td>${allDetails.mobileNo}</td>
						        </tr>
						        <tr>
						            <th>MailId</th>
						            <td>:</td>
						            <td>${allDetails.mail}</td>
						        </tr>
						        <tr>
						            <th>Aadhaar No.</th>
						            <td>:</td>
						            <td>${allDetails.aadhaar}</td>
						        </tr>
						    </tbody>
						</table>
					</div>
					
					<div class="col-md-4">
					    <table style="" class="">
					        <tbody>
					            <tr>
					                <th style="width: 40%">Date Of Birth</th>
					                <td style="width: 10%">:</td>
					                <td style="width: 50%">${allDetails.dob != null ? allDetails.dob : 'NA'}</td>
					            </tr>
					            <tr>
					                <th>Age</th>
					                <td>:</td>
					                <td>${not empty allDetails.age  ? allDetails.age : 'NA'}</td>
					            </tr>
					            <tr>
					                <th>Employment Status</th>
					                <td>:</td>
					                <td>${not empty allDetails.employmentStatus ? allDetails.employmentStatus : 'NA'}</td>
					            </tr>
					            <tr>
					                <th>Organization Name</th>
					                <td>:</td>
					                <td>${not empty allDetails.organizationNname ? allDetails.organizationNname : 'NA'}</td>
					            </tr>
					            <tr>
					                <th>Current Designation</th>
					                <td>:</td>
					                <td>${not empty allDetails.currDesgn ? allDetails.currDesgn : 'NA'}</td>
					            </tr>
					            
					        </tbody>
					    </table>
					</div>
					<div class="col-md-4">
					    <table style="" class="">
					        <tbody>
					            
					            <tr>
					                <th style="width: 40%">Notice Period</th>
					                <td style="width: 10%">:</td>
					                <td style="width: 50%">${not empty allDetails.noticePeriod ? allDetails.noticePeriod : 'NA'}</td>
					            </tr>
					            <tr>
					                <th>Preferred Date</th>
					                <td>:</td>
					                <td>
					                 <c:if test="${not empty allDetails.preferredDate }">
									    <c:choose>
										    <c:when test="${fn:length(allDetails.preferredDate) == 10}">
										        ${allDetails.preferredDate}  <!-- Already in dd/MM/yyyy, print as it is -->
										    </c:when>
										    <c:otherwise>
										        <fmt:parseDate value="${allDetails.preferredDate}" var="parsedDate" pattern="yyyy-MM-dd HH:mm:ss" />
										        <fmt:formatDate value="${parsedDate}" pattern="dd/MM/yyyy" />
										    </c:otherwise>
										</c:choose>
                                     </c:if>
                                     <c:if test="${empty allDetails.preferredDate }">
                                         NA
                                     </c:if>
									</td>

					            </tr>
<!-- 					            <tr> -->
<!-- 					                <td><strong>View Resume</strong></td> -->
<!-- 					                <td>:</td> -->
<!-- 					                <td><a href="#">View Resume</a></td> -->
<!-- 					            </tr> -->
					        </tbody>
					    </table>
					</div>
                 </div>
                 <div class="col-md-12">
			  <div class="card">
			    <div class="card-header">
			      <h5 class="card-title">Uploaded Documents</h5>
			    </div>
			    <div class="card-body">
			      		<table class="table table-bordered table-hover table-striped mb-none dataTable" id="datatable-svr" style="width:100%;">
									<thead>
										<tr>
										    <th style="text-align: center;width: 60px;">Sl. No</th>
										    <th>Document Name</th>
										    <th style="width: 100px;">Action</th>
										</tr>
									</thead>
									<c:forEach items="${docList}" var="data" varStatus="status">
										<tr>
											<td class="text-center">${status.count}</td>
											<td>${data.recruitmentDocument.name}</td>
											<td>
												<button class="btn btn-primary" title="Download" type="button" onclick="downloadDoc('${data.candidateVacancyMapping.candId.code}/${data.candidateVacancyMapping.candId.code}${data.recruitmentDocument.code }','${data.fileName}')" style="font-size:16px;"><i class="fa fa-download"></i></button>
											</td>
										</tr>
									</c:forEach>
								</table>
			    </div>
			  </div>
			</div>
                 <div class="col-md-12 text-center mt-3">
					<div class="form-group">
						<div class="col-md-12">
						 <a href="javascript:window.history.back();" class="btn btn-warning" style="margin-top: 0px;">Back</a>
					</div>
				</div>
             </div>
          </div>
        </div> 
     </div>
 </div>
 <form action="${contextPath}/download-candidate-docs" method="POST" id="downloadDocument" target="_blank">
    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" /> 
    <input type="hidden" id="downFileName" name="fileName">
    <input type="hidden" id="downCandidateCode" name="candidateCode">
</form>
</body>
</html>

<script>

function downloadDoc(candidateCode,fileName){
	$("#downCandidateCode").val(candidateCode);
	$("#downFileName").val(fileName);
	$("#downloadDocument").submit();
	
}

</script>