<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles"%>
<%@ page language="java" pageEncoding="utf-8"
	contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<%--<jsp:useBean id="strUtils" class="com.aashdit.demography.utils.ApplicationStringUtils"/>--%>


                <div class="panel-header bg-primary-gradient">
					<div class="page-inner py-4">
						<div class="d-flex align-items-left align-items-md-center flex-column flex-md-row">
 							<div>
								<h2 class="text-blue pb-2 fw-bold">Manage Fund</h2>
							</div> 
							<div class="ml-md-auto mb-4 py-2 py-md-0">
								<a href="${contextPath}" class="btn btn-sm btn-border btn-blue btn-round mr-2"><i class="fa fa-home"></i></a>
								<a href="#" class="btn btn-sm btn-border btn-blue btn-round mr-2"> Manage Fund</a>
							</div>
						</div>
					</div>
				</div>
				
				
	
				<div class="page-inner pb-0">
					<div class="row mt--2">
							
						<div class="col-md-12">
							<div class="card full-height">
								<div class="card-header">
									<h4 class="card-title"> Fund Requested List</h4>
									<div class="panel-actions">
										<a href="#" class="fa fa-caret-down"></a>
									</div>
								</div>
								<div class="card-body" style="">
									
									<div class="col-md-12" id="tabs">
										<ul class="nav nav-pills">
											<li class="nav-item" >
												<a class="nav-link active" data-bs-toggle="tab" href="#pending" id="a">Pending</a>
											</li>
											<li class="nav-item" >
												<a class="nav-link" data-bs-toggle="tab" href="#approved" id="b">Approved</a>
											</li>
											<li class="nav-item" >
												<a class="nav-link" data-bs-toggle="tab" href="#reject" id="c">Reverted</a>
											</li>
										</ul>

										<!-- Tab panes -->
										<div class="tab-content">
											<div class="tab-pane active" id="pending">
												<div class="col-md-12">
													<table class="table table-bordered DataTable mt-4 mb-4 text-center" >
														<thead>
															 <tr>
                                                            <th style="width: 55px;">Sl No.</th>
                                                            <th>Financial Year</th>
                                                            <th>Fund Created Date </th>
                                                            <th>Fund Type </th>
                                                            <th>Component Name</th>
                                                            <th> Entity Type</th>
                                                            <!-- <th> Entity Name</th> -->
                                                            <th>Amount</th>
                                                            <th>Current Stage</th>
                                                            <th>Action</th>
                                                        </tr>
														</thead>
														<tbody>
														 <c:forEach items="${fndPendingList}" var="fndPending" varStatus="count">
														     <tr>
																<td>${count.count}</td>
	                                                            <td>${fndPending.finyear.finYearr}</td>
	                                                            <td><fmt:formatDate type = "date"  value = "${fndPending.transDate}" /></td>
	                                                            <td>${fndPending.fundType.fundTypeName}</td>
	                                                              <td>${fndPending.entitySchemeMapping.scheme.schemeName}</td>
	                                                              <td>${fndPending.entitySchemeMapping.cboType.valueEn}</td>
	                                                              <!-- <td>${fndPending.entityBeneficiaryMapping.beneficiaryName}</td> -->
	                                                            <td class="text-right">${fndPending.amount}</td>
	                                                            <td>${fndPending.stageForwardedRule.toStageMaster.stageNameEn}</td>
																<td>
																   <a href="#" onclick="viewFundDtlsById(${fndPending.fundId})" class="btn btn-success btn-sm" title="View"><i class="fas fa-eye"></i></a>
																</td>
															</tr>
														</c:forEach>
														</tbody>
													</table>
												</div>
											</div>
											<div class="tab-pane fade" id="approved">
												<table class="table table-bordered DataTable mt-4 mb-4 text-center" >
															<thead>
															<tr>
                                                            <th style="width: 55px;">Sl No.</th>
                                                            <th>Financial Year</th>
                                                            <th>Fund Creation Date </th>
                                                            <th>Fund Type </th>
                                                            <th>Component Name</th>
                                                            <th> Entity Type</th>
                                                            <!-- <th> Entity Name</th> -->
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                            </tr>
														   </thead>
														<tbody>
														 <c:forEach items="${fndApprovedList}" var="fndApproved" varStatus="count">
														     <tr>
																<td>${count.count}</td>
	                                                            <td>${fndApproved.finyear.finYearr}</td>
	                                                            <td><fmt:formatDate type = "date"   value = "${fndApproved.transDate}" /></td>
	                                                            <td>${fndApproved.fundType.fundTypeName}</td>
	                                                            <td>${fndApproved.entitySchemeMapping.scheme.schemeName}</td>
	                                                             <td>${fndApproved.entitySchemeMapping.cboType.valueEn}</td>
	                                                             <!-- <td>${fndApproved.entityBeneficiaryMapping.beneficiaryName}</td> -->
	                                                            <td class="text-right">${fndApproved.amount}</td>
																<td>
															   <a href="#" onclick="viewFundDtlsById(${fndApproved.fundId})" class="btn btn-success btn-sm" title="View"><i class="fas fa-eye"></i></a>
																</td>
															</tr>
														</c:forEach>
														</tbody>
													</table>
											</div>
											<div class="tab-pane fade" id="reject">
												<table class="table table-bordered DataTable mt-4 mb-4 text-center" >
														<thead>
															<tr>
                                                            <th style="width: 55px;">Sl No.</th>
                                                            <th>Financial Year</th>
                                                            <th>Fund Creation Date </th>
                                                            <th>Fund Type </th>
                                                            <th>Component Name</th>
                                                            <th> Entity Type</th>
                                                            <!-- <th> Entity Name</th> -->
                                                            <th>Amount</th>
                                                            <th>Action</th>
                                                           </tr>
														</thead>
														<tbody>
														 <c:forEach items="${fndRejectedList}" var="fndRejected" varStatus="count">
														     <tr>
																<td>${count.count}</td>
	                                                            <td>${fndRejected.finyear.finYearr}</td>
	                                                            <td><fmt:formatDate type = "date"   value = "${fndRejected.transDate}" /></td>
	                                                            <td>${fndRejected.fundType.fundTypeName}</td>
	                                                            <td>${fndRejected.entitySchemeMapping.scheme.schemeName}</td>
	                                                            <td>${fndRejected.entitySchemeMapping.cboType.valueEn}</td>
	                                                            <!-- <td>${fndRejected.entityBeneficiaryMapping.beneficiaryName}</td> -->
	                                                            <td class="text-right">${fndRejected.amount}</td>
																<td>
																   <a href="#" onclick="viewFundDtlsById(${fndRejected.fundId})" class="btn btn-success btn-sm" title="View"><i class="fas fa-eye"></i></a>
																</td>
															</tr>
														</c:forEach>
														</tbody>
													</table>
											</div>
										</div>
										
									</div>
								</div>
							</div>
						</div>
					</div>
					</div>

<form method="GET" id="formId">
 <input type="hidden" name="tabCode" id="tabCode" value="${tabCode}">
 <input type="hidden" name="viewType" id="viewType" value="REQUESTED_BDG">
</form>
<script >
	function viewFundDtlsById(fundId){
		$("#formId").attr('action','${contextPath}/fnd/fund/view/'+ fundId +'');
	    $("#formId").submit();
	}
	function editFundDtlsById(fundId){
		$("#formId").attr('action','${contextPath}/fnd/fund/edit/'+ fundId +'');
	    $("#formId").submit();
	}
	
	
	$(document).ready(function() {
	     if('${tabCode}'=='TAB1'){
	    	$("#pending").addClass("in active");
	    	$("#a").addClass("active");
	    	
	    }else if('${tabCode}'=='TAB2'){
	    	$("#approved").addClass("active show");
	    	$("#b").addClass("active");
	    	
	    }else if('${tabCode}'=='TAB3'){
	    	$("#reject").addClass("active show");
	    	$("#c").addClass("active");
	    	
	    }else{
	    	$("#pending").addClass("in active");
	        $("#a").addClass("active");
	    }
	    
	});
	
	$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		  var target = $(e.target).attr("href") // activated tab
		  if(target=="#pending"){
			  $("#tabCode").val("TAB1");
		  }else if(target=="#approved"){
			  $("#tabCode").val("TAB2");  
		  }else if(target=="#reject"){
			  $("#tabCode").val("TAB3");  
		  }
		});
	</script>	
				