<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<script src="${contextPath}/assets/appJs/validation/common-utils.js"></script>
<div class="content">
	<div class="breadcrumb_conatiner">
		<div class="col-md-6">
			<h4 class="change-color">Add & Manage Head</h4>
		</div>
		<div class="col-md-6">
			<nav aria-label="breadcrumb">
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="${contextPath}/home"><i class="fa fa-home"></i></a></li>
					<li class="breadcrumb-item active" aria-current="page">Manage Head</li>
				</ol>
			</nav>
		</div>
	</div>
	<div class="page-inner">
		<div class="row mt-2">

			<div class="col-md-12">
				<div class="card full-height">
					<div class="card-header">
						<c:choose>
							<c:when test="${not empty head.headId}">
								<h4 class="card-title">Update Head</h4>
							</c:when>
							<c:otherwise>
								<h4 class="card-title">Add Head</h4>
							</c:otherwise>
						</c:choose>
					</div>
					<div class="card-body">
						<div class="row">
							<form action="${contextPath}/admin/master/head/save" id="addHeadFrm"
								method="post">
								<input type="hidden" name="${_csrf.parameterName}"
									value="${_csrf.token}" /> <input type="hidden" name="headId"
									value="${head.headId}" id="headId" />
								<div class="col-md-12 row">
									<div class="col-md-3">
										<div class="form-group">
											<label class="col-md-12 required" for="fundTypeName">Head Name :</label>
											<div class="col-md-12">
												<input type="text" class="form-control form-control-sm AlphaNumericOnly" id="headName" name="headName" value="${head.headName}" required="required" maxlength="20" >
											</div>
										</div>
									</div>
									<div class="col-md-3">
                                        <div class="form-group">
                                            <label class="col-md-12" for="fundTypeName">Head Code :</label>
                                            <div class="col-md-12">
                                                <input type="text" class="form-control form-control-sm AlphaNumericOnly" id="" name="" value="${head.headCode}" maxlength="20" readonly>
                                            </div>
                                        </div>
                                    </div>
								
									<div class="text-center" style="margin-top: 20px;">
										<c:choose>
											<c:when test="${not empty head}">
												<input type="button" name="add&ManageApplicationScheme"
													value="Update" id="add&ManageApplicationSchemes"
													class="btn btn-success btn-sm" onclick="submitFormData()">&nbsp;&nbsp;
														<a href="${contextPath}/admin/master/head/list" type="button"
													class="btn btn-warning btn-sm">Back</a>
											</c:when>
											<c:otherwise>
												<input type="button" name="add&ManageApplicationScheme"
													value="Submit" id="add&ManageApplicationSchemes"
													class="btn btn-success btn-sm" onclick="submitFormData()">
														<a type="button" class="btn btn-warning btn-sm" onclick="backToModule()">Back</a>
											</c:otherwise>
										</c:choose>

									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row mt-3">
			<div class="col-md-12">
				<div class="card full-height">
					<div class="card-header">
						<h4 class="card-title">Head List</h4>
					</div>
					<div class="card-body">
						<div class="table-responsive">
							<table id="basic-datatables"
								class="display table table-bordered table-hover  exportbtn">
								<thead>
									<tr>
										<th class="text-center" style="max-width:50px;">Sl.No.</th>
										<th>Head Name</th>
										<th>Head Code</th>
										<th>Status</th>
										<th  style="max-width:80px;">Action</th>
									</tr>
								</thead>
								<tbody id="tbd">
									<c:forEach items="${headList}" var="head" varStatus="count">
										<tr>
											<td class="text-center">${count.count}</td>
											<td>${head.headName}</td>
											<td>${head.headCode}</td>
											<c:if test="${head.isActive eq true }">
												<td>Active</td>
											</c:if>
											<c:if test="${head.isActive eq false }">
												<td>InActive</td>
											</c:if>
											<td>
											<c:if test="${head.isActive eq true}">
											<button class="btn btn-warning btn-sm"
													onclick="editFundTypeById('${head.headId}')" title="Edit Head ">
													<i class="fas fa-edit"></i>
												</button>
												<button class="btn btn-danger btn-sm"
														onclick="activeInactiveHead('INACTIVE', '${head.headId}')"
														title="Deactivate Head ">
														<i class="fa fa-lock" aria-hidden="true"></i>
													</button>
											</c:if> <c:if test="${head.isActive eq false}">
													<button class="btn btn-success btn-sm"
															onclick="activeInactiveHead('ACTIVE', '${head.headId}')"
															title="Activate Head ">
													<i class="fa fa-unlock-alt" aria-hidden="true"></i>
													</button>
											</c:if>
												
											</td>
										</tr>
									</c:forEach>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<form method="GET" id="formId"></form>

<form action="${contextPath}/admin/master/head/changeHeadStatus.htm"
	id="changeHeadStatus" method="post">
	<input type="hidden" name="${_csrf.parameterName}"
		value="${_csrf.token}" /> <input type="hidden" name="actionType"
		id="actionType" /> <input type="hidden" name="headId" id="hdId" />
</form>
<script type="text/javascript">


function editFundTypeById(id) {
	$("#formId").attr('action',
			'${contextPath}/admin/master/head/edit/' + id + '');
	$("#formId").submit();
}
	
	function submitFormData(){	
					
		if($("#headName").val()==""){
			bootbox.alert("Please enter Head Name");
			return false;
		}else{	

			var flag = window.confirm("Do you want to continue ?");
	  		if (flag == true) {
	  			$("#addHeadFrm").submit();

		}
									
	}
		
	}
	function activeInactiveHead(actionType, headId) {
		$("#actionType").val(actionType); 
		$("#hdId").val(headId); 
		if(actionType == 'INACTIVE') {
			bootbox.confirm({
			    message: "Do you want to deactivate the Head?",
			    buttons: {
			        confirm: {
			            label: 'Yes',
			            className: 'btn-success'
			        },
			        cancel: {
			            label: 'No',
			            className: 'btn-danger'
			        }
			    },
			    callback: function (result) {
			    	if(result == true) {
			    		$("#changeHeadStatus").submit();  
			    	} 
			    }
			}); 
		}
		if(actionType == 'ACTIVE') {
			bootbox.confirm({
			    message: "Do you want to activate Head?",
			    buttons: {
			        confirm: {
			            label: 'Yes',
			            className: 'btn-success'
			        },
			        cancel: {
			            label: 'No',
			            className: 'btn-danger'
			        }
			    },
			    callback: function (result) {
			    	if(result == true) {
			    		$("#changeHeadStatus").submit();  
			    	} 
			    }
			}); 
		}
	}

	
	</script>

