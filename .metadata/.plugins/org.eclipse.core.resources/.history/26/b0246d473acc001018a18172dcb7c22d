<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>

<c:set var="contextPath" value="${pageContext.request.contextPath}" />

<%-- <link href="${contextPath}/assets/css/login-css.css" rel="stylesheet" type="text/css"> --%>
<style>
#messageDiv{
    height: auto;
}

/*  body {
    font-family: "Roboto", sans-serif;
    font-size: 14px;
    line-height: 24px;
    color: #484848;
    background-color: #f4f4f4;
    position: relative;
} */


 body {
    display: flex;
    align-items: center;
    justify-content: start;
    flex-direction: column;
    flex-wrap: wrap;
    background: url(assets/images/loginPage/portfolio-1.jpg);
    background-size: cover;
    background-repeat: no-repeat;
    height: 100vh;
    position: relative;
} 
body::before{
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(13, 13, 12, 0.5);
    mix-blend-mode: normal;
    z-index: -1;
}

.padding_right {
    padding-right: 0px !important;
}
.padding_left {
    padding-left: 0px !important;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
    /* font-family: 'Roboto Slab', serif; */
    font-weight: 500;
    line-height: 1.1;
    color: #484848;
}
.hm_color {
    color: #fc5a6d;
}
a:hover,
a:focus {
    text-decoration: none !important;
    outline: none !important;
}
.form-group input[type="text"]:focus,
.form-group input[type="password"]:focus,
.form-group input[type="tel"]:focus,
.form-group input[type="email"]:focus,
.form-group input[type="search"]:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #3b5998 !important;
}
.margin_btm30 {
    margin-bottom: 30px;
}
/*----preloader css----*/

.loader {
    width: 100%;
    height: 100%;
    position: fixed;
    background-color: #fc5a6d;
    z-index: 10000000;
}
@keyframes ball-scale-ripple-multiple {
    0% {
        -webkit-transform: scale(0.1);
        transform: scale(0.1);
        opacity: 1;
    }
    70% {
        -webkit-transform: scale(1);
        transform: scale(1);
        opacity: 0.7;
    }
    100% {
        opacity: 0.0;
    }
}
@-webkit-keyframes ball-scale-ripple-multiple {
    0% {
        -webkit-transform: scale(0.1);
        transform: scale(0.1);
        opacity: 1;
    }
    70% {
        -webkit-transform: scale(1);
        transform: scale(1);
        opacity: 0.7;
    }
    100% {
        opacity: 0.0;
    }
}


.main-box {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    flex-wrap: wrap;
    width: 100%;
}

form{
    width: 100%;
}
i.bx.bx-show.viewpassword {
    right: 5px;
    left: auto;
}
.loginheading{
        position: relative;
    top: -30px;
    background: #fff;
    padding: 28px 25px 9px;
    left: -40px;
    width: 60%;
    font-size: 20px;
}
h4.loginheading:after {
        content: '';
    position: absolute;
    width: 0;
    height: 0;
    border-top: 50px solid transparent;
    border-bottom: 21px solid transparent;
    border-left: 21px solid #fefffe;
    right: -20px;
    top: -1px;
}

.login-box {   
    display: flex;
    justify-content: center;
    flex-direction: column;
    /* align-items: center; */
    height: 370px;
    width: 412px;
    background-size: 100% 100%;
    padding: 0 40px 40px 40px;
    position: fixed;
    right: 118px;
    top: 50%;
    transform: translate(0, -55%);
    z-index: 9999999;
    background: #fff;
    /* background-image: url(../images/login-bg-b.png); */
}
.btmlftbg{
     position: fixed; 
     bottom: 0; 
     left: 0;
     width: 55%;
}
.login-box:before{
    /* position: absolute;
    top: 36px;
    left: 6px;
    content: '';
    height: 440px;
    width: 400px;
    background-image: url(../images/login-bg-t.png);
    background-size: 100% 100%;
    animation: animate-one 1s ease 600ms backwards; */
}
@keyframes animate-one {
 from {
  transform: translateX(-30px);
  transform: rotate(-20deg);
 }
 to {
  transform: translate(0px);
  transform: rotate(0deg);
 }
}

.login-fild {
    display: flex;
    flex-direction: column;
    width: 100%;
    position: relative;
    margin-top: 15px;
}
.login-fild label {
    color: #000;
    font-size: 14px;
    margin-bottom: 3px;
    margin-right: -10px;
}
.login-fild input[type="text"], .login-fild input[type="password"], select {
    height: 36px;
    padding: 0px 0 0 32px;
    position: relative;
    border-radius: 0;
    outline: none;
    font-size: 15px;
    border: none;
    font-weight: 400;
    letter-spacing: -0.2px;
    background-color: transparent;
    border-bottom: #999997 1px solid;
}
.login-fild input:before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
}
.login-fild > i {
    position: absolute;
    bottom: 2px;
    left: 0;
    color: #7b7575;
    z-index: 999;
    line-height: 34px;
    text-align: center;
    font-size: 18px;
}
.iconrefresh{
    font-size: 24px !important;
}
.login-box h2 {
    text-align: left;
    position: relative;
    display: flex;
    width: auto;
    font-weight: 700;
    font-size: 24px;
    color: #454545;
    margin-top: 0;
    justify-content: flex-start;
    text-transform: uppercase;

}
.login-box button {
    background: #854902;
    height: 48px;
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    border-radius: 8px;
    color: #ffffff;
    width: 100%;
    transform: translate(-50%, 0);
    position: relative;
    left: 50%;
    border: none;
}
.button-style-custom{
  /* height: 34px; */
  border-radius: 8px;
  padding: 4px 40px;
  position: relative;
  font-weight: 500;
  z-index: 1;
}

.login-box h2:before {
    content: '';
    position: absolute;
    height: 13px;
    width: 2px;
    background: #fff;
    left: -3px;
    top: 3px;
}
.login-box h2:after {
    content: '';
    position: absolute;
    width: 15px;
    height: 2px;
    background: #fff;
    left: -3px;
    top: 1px;
}
.captchaimg{
    position: absolute;    
    right: 8px;
    top: 5px;    
    height: 26px;    
    font-size: 20px;    
    background: #fff;    
    font-family: cursive;
    font-style: italic;
}
.login-box h2 span {
    position: relative;
    width: 100%;
    float: left;
}
.login-box h2 span:before {
    content: '';
    position: absolute;
    height: 13px;
    width: 2px;
    background: #fff;
    right: -3px;
    bottom: 3px;
}
.login-box h2 span:after {
    content: '';
    position: absolute;
    width: 15px;
    height: 2px;
    background: #fff;
    right: -3px;
    bottom: 1px;
}

.fp {
       width: 100%;
    float: left;
    text-align: right;
    color: #1654c0;
    font-size: 14px;
    font-weight: 500;
    text-decoration: none;
}
.fp:hover{
    color: #f18404 ;
}
.submit-btn {
    position: relative;
    top: 5px;
}
.submit-btn a {
    text-align: center;
    color: #fff;
    text-decoration: none;
    text-transform: capitalize;
    font-weight: 500;
    font-size: 17px;
}
.logo-box {
    display: flex;
    align-items: center;
    position: relative;
    top: 10px;
    left: -40px;
    width: auto;
}

/* .logo-box:before{
    content: '';
    position: absolute;
    left: -102px;
    top: -80px;
    background-image: url(../images/header-top.png);
    width: 679px;
    height: 278px;
    flex-shrink: 0;
    z-index: -1;
    animation: drop-in 1s ease 200ms backwards;
} */
@keyframes drop-in {
 from {
  opacity: 0;
  transform: translateY(-500px);
 }
 to {
  opacity: 1;
  transform: translate(0px);
 }
}
.logo-box h1 {
    font-size: 70px;
    font-weight: 800;
    color: #333;
    margin-bottom: 0px;
    line-height: 55px;
    position: relative;
    left: -3px;
}
.logo-box {

}
.logo-img {
      width: 80px;
    margin-right: 0px;
    padding-right: 12px;
    margin-left: 0;
}
.logo-box h1 span {
    color: #8d4b17;
}
.logo-content{
    text-align: center;
}
.logo-box h4 {
    color: #0a0a0a;
    font-size: 34px;
    margin-top: 3px;
    margin-bottom: 3px;
    font-weight: 700;
    font-family: "Roboto Condensed", sans-serif;
}

.logo-box p {
    margin: 0;
    color: #69520d;
    font-size: 16px;
    font-weight: 600;
    background: #fcd96b;
    border-radius: 6px;
    padding: 5px 15px;
    font-family: "Roboto Condensed", sans-serif;
    text-align: center;
}

@keyframes pop-in {
 0% {
  opacity: 0;
  transform: translateX(-500px);
 }
 15% {
  opacity: 0.8;
  transform: translate(0px);
  transform: scale(70%);
 }
 50% {
  opacity: 1;
  transform: scale(100%);
 }
 100% {
  opacity: 1;
  transform: scale(100%);
 }
}
.copyright {
    position: fixed;
    right: 76px;
    bottom: 0;
    padding: 10px 62px;
    width: 500px;
    display: flex;
    align-items: center;
    justify-content: center;
}
.copyright:before{
    position: absolute;
    content: '';
    left: 50%;
    top: 50%;
    transform: translate(-50%, -60%);
    height: 122px;
    width: 500px;
    background-image: url(assets/images/loginPage/footer-btm.png);
    z-index: -1;
    animation: pop-up 3s ease 400ms backwards;
}
@keyframes pop-up{
 from {
  opacity: 0;
  transform: translate(-50%, 100%);
 }
 to {
  opacity: 1;
  transform: translate(-50%, -60%);
 }
}
.copyright p {
    margin-bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: fit-content;
    letter-spacing: 1px;
    position: relative;
    bottom: -6px;
    color: #191919;
    font-family: 'Rajdhani', sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: 600;
    line-height: normal;
    text-transform: uppercase;
    animation: pop-up-two 3s ease 400ms backwards;
}
@keyframes pop-up-two{
 from {
  opacity: 0;
  transform: translateY(100px);
 }
 to {
  opacity: 1;
  transform: translateY(0px);
 }
}
.copyright p a {
    float: left;
}
.copyright p img {
    width: 80px;
}




.jcb {
    position: fixed;
    bottom: 0;
    right: -25px;
    z-index: 9999999;
    width: 270px;
}

/* login page2 */
.build_const{
    padding: 20px 0;
}
.logo-boxs{
    display: flex
;
    align-items: center;
    gap: 10px;
}
.construction_login{
    background: url(assets/images/loginPage/portfolio-1.jpg) ;
    background-size: cover;
    background-repeat: no-repeat;
    height: 100vh;
    position: relative;
}
.construction_login::before{
  content: "";
    position: absolute;
    inset: 0;
    background: rgba(13, 13, 12, 0.5);
    mix-blend-mode: normal;
    z-index: -1;
}
.build_con h4{
    color: #fff;
    font-size: 30px;
    margin-top: 3px;
    margin-bottom: 3px;
    font-weight: 700;
    font-family: "Roboto Condensed", sans-serif;
    display: block;
    text-shadow: 0 0 80px rgba(255, 255, 255, 0.5);
    background: url(assets/images/loginPage/animated-text.png) repeat-y;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    -webkit-animation: aitf 80s linear infinite;
    -webkit-transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;

}
@-webkit-keyframes aitf {
    0% {
        background-position: 0% 50%;
    }
    100% {
        background-position: 100% 50%;
    }
}
.logo-image img{
    filter: invert(1);
}
.build_con p{
    color: #fff;
    font-size: 14px;
    font-weight: 600;
    background: #f18404 ;
    border-radius: 6px;
    padding: 5px 15px;
    font-family: "Roboto Condensed", sans-serif;
    text-align: center;
    margin: 0;
}
.login_form{
    padding: 40px 0;
}
.form_box{
     max-width: 470px;
     min-height: 420px;
    width: 100%;
    margin: 0 auto;
    text-align: center;
    padding: 40px 60px;
    background: linear-gradient(146.48deg, rgba(255, 255, 255, 0.5) 1.3%, rgba(0, 0, 0, 0.1) 117.69%);
    backdrop-filter: blur(15px);
    position: relative;
    z-index: 0;
    border-radius: 0.375rem;
        box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.175);
}
.form_box h4{
        color: #fff;
    font-size: 30px;
    margin-bottom: 24px;
}
.fild_set > .icon_cl{
    color: #fff;
}
.fild_set input {
    color: #fff; 
    background-color: #ffffffcc; 
    border: 1px solid #ccc; 
    padding: 10px;
}
.fild_set input::placeholder {
    color: #ffffffcf; 
    opacity: 1;
}
.fild_set button{
    padding: 0.6rem 2.6rem;
    font-weight: 600;
    background: #f18404;
    border: none;
    border-radius: 0.375rem;
    font-size: 16px;
    color: #fff;
    letter-spacing: 1px;
}
.captchaimgs{
        position: absolute;
    right: 5px;
    top: 0px;
    padding: 3px 6px;
    font-size: 20px;
    background: #fff;
    font-family: cursive;
    font-style: italic;
}
.fp {
    color: #fff;
}
.remember_me{
        margin-left: -50px;
}
.check_box{
        background: transparent;
    border: 1px solid #ffffff75;
}
hr {
    margin: 1rem 0;
    color: inherit;
    background-color: rgb(255 255 255 / 23%);
    border: 0;
    opacity: 1;
}
 .social-icons {
    margin: 0;
    padding: 0;
    display: flex
;
    flex-wrap: wrap;
    list-style: none;
   gap: 5px;
}
.icons-circle a{
    display: block;
    height: 38px;
    line-height: 38px;
    width: 38px;
    font-size: 18px;
    text-align: center;
    color: #fff;
    text-decoration: none;
    transition: all 0.2s ease;
    border-radius: 50%;
}
.social-icons li:nth-child(1) a {
  background-color: #3b5998; /* Facebook Blue */
}

.social-icons li:nth-child(2) a {
  background-color: #000000; /* Twitter X black */
}

.social-icons li:nth-child(3) a {
  background-color: #db4437; /* Google Red */
}

.social-icons li:nth-child(4) a {
  background-color: #0077b5; /* LinkedIn Blue */
}
.icons-circle i{
	margin: 0;
}




@media screen and (min-width: 1024px) and (max-width: 1439px){
    #login-window .row.mt-5.mb-5{
        margin-top: 20px !important;
        margin-bottom: 20px !important;
    }
    .login-cont.p-5{
        padding: 20px !important;
    }
    .login-cont .btn-primary{
        padding: 5px 0 7px;
    }
    .col-md-6.mt-1{
        padding: 0 !important;
    }
}
input:-internal-autofill-selected{
	    background-color: transparent !important;
}
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
textarea:-webkit-autofill,
select:-webkit-autofill {
  -webkit-box-shadow: 0 0 0 1000px transparent inset; /* change 'white' to your background */
  -webkit-text-fill-color: #000; /* text color */
  transition: background-color 5000s ease-in-out 0s;
}
</style>


<div class="container-fluid">
<%-- 	<section class="main-box">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8">
                        <div
                            class="logo-box">
                            <div class="logo-img">
                                <img src="${contextPath}/assets/images/loginPage/fab.png"
                                    class="img-fluid" />
                            </div>
                            <div class>
                                <!-- <h1>I<span>P</span>MS</h1> -->
                                <h4>Building & Construction Management</h4>
                                <p class="title-subheading">ST & SC Development,
                                    Minorities and Backward
                                    Classes Welfare Department</p>
                            </div>
                        </div>

                        <img src="${contextPath}/assets/images/loginPage/left-bg.png"
                            class="img-fluid btmlftbg">
                    </div>
                    <div class="col-lg-4">

                        <div class="login-box mt-4">
                            <h4 class="loginheading">Login</h4>
                            <!-- <h2><span>Login Here</span></h2> -->
                            <form class="form-horizontal loginbox" id="login-window" method="POST" action="${contextPath}/overwrite/umt/login" autocomplete="off">
                                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
                                <div class="login-fild form-group mb-4">
                                    <input type="text" placeholder="Enter Username"  id="userName" name="userName" maxlength="35" class="user">
                                    <i class='fa fa-user'></i>
                                </div>
                                <div class="login-fild form-group mb-4">
                                    <input type="password" placeholder="Enter Password" id="password" name="password" maxlength="30" class="password">
                                    <i class='fa fa-lock'></i>
                                    <span class="fa-regular fa-eye toggle-password viewpassword" toggle="#password-field"></span>
                                    
                                </div>

                                <div class="login-fild form-group mb-4">
                                    <input type="text" placeholder="Enter Captcha" id="captcha" class="cap" maxlength="10">
                                    <i class='fa fa-refresh iconrefresh'></i>
                                    <img src="${contextPath}/captcha/5" alt="" style="width: 90px;" class="captchaimg">
                                </div>
                                <div class="login-fild submit-btn">
                                    	<button type="button" id="btn_submit" class="button-style-custom" onclick="userLogin()">Login Here</button>

                                </div>
                                <div class="login-fild mt-2">
                                    <a href="#" class="fp">Forgot Password?</a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section> --%>
<%--         <img src="${contextPath}/assets/images/loginPage/jcb.png" class="jcb"> --%>



 <section class="build_const">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-12">
        <div class="logo-boxs d-flex align-items-center">
          <div class="logo-image me-3">
            <img src="${contextPath}/assets/images/loginPage/fab.png" class="img-fluid" style="max-height:60px;">
          </div>
          <div class="build_con">
            <h4 style="margin-bottom:5px;">Building & Asset Management System</h4>
            <p class="title-subheading mb-0">ST &amp; SC Development, Minorities and Backward Classes Welfare Department</p>
          </div>
        </div>
      </div>
     
    </div>
  </div>
</section>

        <section class="login_form">
         <div class="container">
               <div class="row">
                <div class="col-md-12">
                   <div class="form_box ">
                            <h4 class="">Login</h4>
                            <form class="form-horizontal loginbox" id="login-window" method="POST" action="${contextPath}/overwrite/umt/login" autocomplete="off">
                                 <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
                                <div class="login-fild fild_set form-group mb-4">
                                    
                                     <input type="text" placeholder="Enter Username"  id="userName" name="userName" axlength="35"  class="user">
                                      <i class='fa fa-user icon_cl'></i>
                                  
                                </div>
                                <div class="login-fild fild_set form-group mb-4">
                                   
                                      <input type="password" placeholder="Enter Password" id="password" name="password" maxlength="30" class="password">
                                    <i class='fa fa-lock icon_cl'></i>
                                   
                                    <i class="bx bx-lock icon_cl"></i>
                                    <i class="bx bx-show viewpassword icon_cl"></i>
                                </div>

                                <div class="login-fild fild_set form-group mb-4">
                                  <input type="text" placeholder="Enter Captcha" id="captcha" class="cap" maxlength="10">
                                    <i class='fa fa-refresh iconrefresh icon_cl'></i>
                                    <img src="${contextPath}/captcha/5" alt="" style="width: 90px;" class="captchaimg">

                                </div>
                                <div class="login-fild fild_set submit-btn">
                                <button type="button" id="btn_submit" class="button-style-custom" onclick="userLogin()">Login</button>
                                
                                </div>
                                <div class="login-fild mt-2">
                                    <div class="row">
                                        <div class="col-md-6" style="
    margin-left: -16px;
">
                                       
                      <div class="form-check" >
                       <!--  <input id="remember-me" name="remember" class="form-check-input check_box" type="checkbox">
                        <label class="form-check-label text-light remember_me" for="remember-me">Remember Me</label>
 -->
      
<!--                        <a href="#" class="fp" data-bs-toggle="modal" data-bs-target="#otpModal">Request Building Proposal </a> -->
                            <a href="#" class="fp" data-bs-toggle="modal" data-bs-target="#proposalModal">Building Proposal</a>
                      </div>
                
                                        </div>
                                        <div class="col-md-6">
                                            <a href="#" class="fp" data-bs-toggle="modal" data-bs-target="#forgotPassModal">Forgot Password?</a>
                                        </div>
                                    </div>
                                </div>
                            </form>


                        </div> 
                </div>
            </div>
         </div>
        </section>





	<%-- <div class="row logo_section mt-md-5 mt-2">
		<div class="col-6">
			<div class="site-logo">
				<img src="${contextPath}/assets/images/loginPage/corporatelogo.png" alt="Logo"/>
			</div>
		</div>
		<div class="col-6">
			<div class="odisha-logo">
				<img src="${contextPath}/assets/images/loginPage/aashdittechnology.png" alt="Odisha">
			</div>
		</div>
	</div>
	<div class="row login-section mt-md-3 mt-2">
		<div class="col-md-4 m-auto">
			<div class="login-cont text-center p-5">
				<h4 class="text-center">Login</h4>
				<form id="login-window" method="POST" action="${contextPath}/overwrite/umt/login" autocomplete="off">
					<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
					<div class="row mt-5 mb-5">
						<div class="userName col-12 mb-4 position-relative">
							<input type="text" placeholder="Enter Username" id="userName" name="userName" maxlength="35">
							<i class="fa-solid fa-user"></i>
						</div>
						<div class="userPsd col-12 mb-4 position-relative">
							<input type="password" placeholder="Enter Password" id="password" name="password" maxlength="30">
							<i class="fa-solid fa-lock "></i>
							<span class="fa-regular fa-eye toggle-password" toggle="#password-field"></span>

						</div>
						<div class="col-6">
							<input type="text" placeholder="Enter Captcha" id="captcha" name="captcha" maxlength="5">
						</div>
						<div class="col-4">
							<img src="${contextPath}/captcha/5" alt="" style="width: 80%;">
						</div>
						<div class="col-2">
							<a href="" id="captchaImage"><img src="${contextPath}/assets/images/loginPage/recaptcha.png" id="captcha" style="width: 100%;" onclick="refreshCaptcha()" ></a>
						</div>
						<div class="col-12 mt-5">
							<button type="button" class="btn btn-primary" onclick="userLogin()">Login</button>
						</div>
						<div class="col-md-6 mt-1" style="float: left;">
							<a href="${contextPath}/public/vacancyViewPage" class=" fp" style="font-size: 12px;">View Vacancies & Apply</a>
						</div>
						<div class="col-md-6 mt-1 text-end" style="float: right;">
                            <a href="${contextPath}/public/addGrievance" class=" fp" style="font-size: 12px;">Lodge Grievance</a>
                        </div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div> --%>

       

<%-- <div id="forgotPassModal" class="modal fade" role="dialog"  tabindex="-1" aria-labelledby="forgotPassModalLabel" aria-hidden="true" style="z-index:99999;">
	<div class="modal-dialog" style="width: 380px;">
		<div class="modal-content">
			<div class="modal-header">
				<h6 class="modal-title">Forgot Password ?</h6>
				<button type="button" class="close" data-bs-dismiss="modal">&times;</button>
				<span id="SecondsUntilExpire" style="display: none;"></span>
			</div>
			<div class="modal-body col-md-12">
				<div class="" id="contents">
					<form style="padding:5px" class="form-horizontal" id="resetform" action="${contextPath}/umt/reset/forgot-password-send-otp" onsubmit="disableButton()" method="post">
						<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />

						<div class="col-md-12">
							<label>User Name<span style="color: #ff0808;">*</span> :</label>
						</div>
						<div class="col-md-12">
							<input type="text" class="form-control" id="username" name="username" required maxlength="64">
						</div>
						<div class="col-md-12 mt-2">
							<button type="button" onclick="passwordReset()" id="passwordResetBtn" class="btn btn-sm btn-primary" style="background-color:#a9230b; border:none; font-size: 12px;">Submit</button>
							<button type="button" class="btn btn-sm btn-danger" style="background-color: #339355; border: none; font-size: 12px;" data-dismiss="modal">Cancel</button>
						</div>
					</form>
				</div>
			</div>
			<div class="modal-footer text-center">
				<div class="col-md-12">
					<label style="font-style: italic; color: #ff0808; font-size: 12px;">
						Note: Password will be sent to the registered email id.
					</label>
				</div>
			</div>
		</div>
	</div>
</div>  --%>
</div>


<!-- forgot password module --> 

<div id="forgotPassModal" class="modal fade" role="dialog" tabindex="-1" aria-labelledby="forgotPassModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="modal-dialog" style="max-width: 380px; margin: auto;">
    <div class="modal-content" style="padding: 0px !important;border-radius: 5px !important;">
      <div class="modal-header border-0">
        <h6 class="modal-title fw-bold text-light" id="forgotPassModalLabel">Forgot Password ?</h6>
        <button type="button" class="btn-close text-danger" aria-label="Close" onclick="window.location.href='${contextPath}/login'"></button>
        <span id="SecondsUntilExpire" style="display: none"></span>
      </div>
      <div class="modal-body col-md-12">
        <div id="contents">
          <form  class="form-horizontal" id="resetform" action="${contextPath}/public/forgotPassword/user/forgot/password" onsubmit="disableButton()" method="post">
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
            
            <div class="col-md-12">
				<label for="username">User Name<span style="color: #ff0808;">*</span> :</label>
			</div>
			<div class="col-md-12">
				<input type="text" class="form-control" id="resetUserName" name="resetUserName" required maxlength="35">
			</div>
			
			<div class="col-md-12 mt-2">
				<button type="button" onclick="generateAndSentOTP()" id="passwordResetBtn" class="btn btn-sm btn-primary" style="background-color:#a9230b; border:none; font-size: 12px;">Sent OTP</button>
				<button type="button" class="btn btn-sm btn-danger" style="background-color: #339355; border: none; font-size: 12px;" data-bs-dismiss="modal">Cancel</button>
			</div>
						
            <div class="mb-2 otpbox" style="display:none">
			   <label>OTP</label>
			   <div class="otpholder otp-only">
				      <input type="text" class="form-control NumbersOnlyWithoutDot" maxlength="1" size="1" id="otp1" oninput="checkOtp()"/>
					  <input type="text" class="form-control NumbersOnlyWithoutDot" maxlength="1" size="1" id="otp2" oninput="checkOtp()"/>
					  <input type="text" class="form-control NumbersOnlyWithoutDot" maxlength="1" size="1" id="otp3" oninput="checkOtp()"/>
					  <input type="text" class="form-control NumbersOnlyWithoutDot" maxlength="1" size="1" id="otp4" oninput="checkOtp()"/>
					  <input type="text" class="form-control NumbersOnlyWithoutDot" maxlength="1" size="1" id="otp5" oninput="checkOtp()"/>
					  <input type="text" class="form-control NumbersOnlyWithoutDot" maxlength="1" size="1" id="otp6" oninput="checkOtp()"/>
			   </div>
			   <a href="javascript:void(0)" style="float: right; padding: 10px; text-decoration: none; color: #1f4e8d; font-weight: 500;" onclick="forgotPasswordByOtp();">Resend OTP</a>   
			</div>
			
			<div id="passwordSet" style="display:none">
				<div class="col-md-12 mb-2">
	              <label for="newPassword" class="form-label fw-semibold text-success">New Password <span class="text-danger">*</span></label>
	            </div>
	            <div class="col-md-12 mb-3">
	              <input type="text" class="form-control px-2" id="newPassword" name="txtPass" required maxlength="25" style="border-radius: 5px !important;" oninput="showSubmitBtn()" onchange="ensureStrongPassword(this);"/>
	            </div>
	            <div class="col-md-12 mb-2">
	              <label for="confirmPassword" class="form-label fw-semibold text-success">Confirm Password <span class="text-danger">*</span></label>
	            </div>
	            <div class="col-md-12 mb-3">
	              <input type="text" class="form-control px-2" id="confirmPassword" name="txtRePass" required maxlength="25" style="border-radius: 5px !important;" oninput="showSubmitBtn()"/>
	              <span id="consms" style="font-size: 14px; font-style: italic;"></span>
	            </div>
	            <div class="row">
							<div class="col-md-12 pl-2 mt-3">
								<div class="alert alert-info" id="lblPass"
									style="text-align: left;">
									Password must be between 8 - 15 characters <br /> - Must have
									one lower case alphabet. <br /> - Must have one upper case
									alphabet. <br /> - Must have one number. <br /> - Must have one
									special sign (@/*/#)
								</div>
							</div>
						</div>
            </div>
            
            <div class="col-md-12 text-center mt-3" id="passwordChangeBtns" style="display:none">
              <!-- <button type="button" onclick="passwordReset()" id="passwordResetBtn" class="btn btn-sm btn-primary" style="background-color: #339355; border: none; font-size: 12px; width:80px; height:30px;"> Submit </button> -->
              <button type="button" class="btn btn-sm btn-danger" style="background-color: #b92a2a; border: none; font-size: 12px; width:80px; height:30px;" data-bs-dismiss="modal" onclick="window.location.href='${contextPath}/login'"> Cancel </button>
            </div>
            
          </form>
        </div>
      </div>
      <div class="modal-footer">
          	<label style="font-style: italic; color: #ff0808; font-size: 12px" id="message"> </label>
			<label style="font-style: italic; color: #ff0808; font-size: 12px;">Note: Password will be sent to the registered email id.</label>
      </div>
    </div>
  </div>
</div>

<!-- OTP Verification Modal -->
<div class="modal fade" id="otpModal" tabindex="-1" aria-labelledby="otpModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="otpModalLabel">Request Building Proposal Verify Yourself</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="otpVerificationForm" method="post">
          <div class="row">
            <!-- Name -->
            <div class="form-group col-md-4">
              <label class="required">Name:</label>
              <input type="text" class="form-control form-control-sm" id="name" name="name" placeholder="Enter Name" required>
            </div>
            <!-- Phone -->
            <div class="form-group col-md-4">
              <label class="required">Phone:</label>
             <input type="tel" 
       class="form-control form-control-sm" 
       id="phone" 
       name="phone" 
       placeholder="Enter Phone Number" 
       pattern="[0-9]{10}" 
       maxlength="10" 
       required
       oninput="this.value = this.value.replace(/[^0-9]/g, '')">

            </div>
            <!-- OTP -->
            <div class="form-group col-md-4">
              <label class="required">OTP:</label>
              <input type="text" class="form-control form-control-sm" id="otp" name="otp" placeholder="Enter 6-digit OTP" disabled maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
              <div class="timer-display" id="timerDisplay"></div>
            </div>
          </div>
          <div class="success-message" id="successMessage" style="display:none;">
            OTP Successfully Verified!
          </div>
          <div class="row mt-4 mb-4">
            <div class="col-md-12 text-center">
              <button type="button" class="btn btn-success btns" id="sendOtpBtn" onclick="sendOtp()">Send OTP</button>
              <button type="submit" class="btn btn-primary btns hidden" id="submitOtpBtn">Submit OTP</button>
              <a href="${contextPath}/home" type="button" class="btn btn-warning btn-sm btns">Back</a>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="proposalModal" tabindex="-1" aria-labelledby="proposalModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="proposalModalLabel">Download BAMS App</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>To send building proposals, please download the BAMS app from the Google Play Store.</p>
        <a href="https://play.google.com/store/apps/details?id=com.example.bams" target="_blank" class="btn btn-primary">
          Download from Play Store
        </a>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

function disableButton(){
	$("#passwordResetBtn").attr('disabled', true);
}
$(function() {
	$('form').attr("autocomplete", "off");
});

var errorMsg = '${err_msg}';
if(errorMsg !=""){
	setTimeout(function() {
	    $('#errorMsg').fadeOut('slow');
	}, 3000);
}

function userLogin() {
	var username = $("#userName").val().trim();
	var password = $("#password").val().trim();
	var generateCaptcha=$("#captcha").val();
    
	if (username == "") {
		bootbox.alert("Username can not be empty.");
		$("#userName").val("");
		return false;
	}else if (password == "") {
		bootbox.alert("Password can not be empty.");
		$("#password").val("");
		return false;
	}else if (generateCaptcha == "") {
		bootbox.alert("Please enter the CAPTCHA."); 
		$("#captcha").val("");
		return false;
	}else {
		showLoader();
		$('#userName').val(enc_password(username));
		$('#password').val(enc_password(password)); 
		$("#login-window").submit();
		return false;
	}
}

document.onkeydown = function(e) {
	/* Block F12 */
	if(event.keyCode == 123) {
		return false;
	}
	/* CTRL + SHIFT + I */
	if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)){
		return false;
	}
	/* CTRL + SHIFT + J */
	if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)){
		return false;
	}
	/* CTRL + SHIFT + C 
	if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)){
		return false;
	}*/
	/* CTRL + U */
	if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)){
		return false;
	}
}

$(document).on('click', '.toggle-password', function() {
    $(this).toggleClass("fa-eye");
	$(this).toggleClass("fa-eye-slash");

	var input = $("#password");
	input.attr('type') === 'password' ? input.attr('type','text') : input.attr('type','password')
});

function refreshCaptcha() {
	var image = document.getElementById("captchaImage");
	image.src = '${contextPath}/captcha/5';
}

function passwordReset(){
	showLoader();
	$("#resetform").submit();
}
</script>


<script>

/* function generateAndSentOTP(){
	var username = $("#resetUserName").val().trim();
    $.ajax({
        url: "${contextPath}/public/generate/otp",
        type: "POST",
        data: {
        	userName: enc_password(username)
        },
        success: function (data) {
   
        	document.addEventListener("DOMContentLoaded", function() {
                var myModal = new bootstrap.Modal(document.getElementById('forgotPassModal'));
                myModal.show();
            });
        	
        	
            
        },
        error: function (error) {
            bootbox.alert(":",error);
        }
    });
} */

function generateAndSentOTP() {
	
    var username = $("#resetUserName").val().trim();
	var token = $("meta[name='_csrf']").attr("content");
	var header = $("meta[name='_csrf_header']").attr("content");
    $.ajax({
        url: "${contextPath}/public/generate/otp",
        type: "POST",
        data: {
            userName: enc_password(username)
        },
        beforeSend: function(xhr) {
            xhr.setRequestHeader(header, token);
        },
        success: function (data) {
            if (data.flag) {
                //Show modal
                var myModal = new bootstrap.Modal(document.getElementById('forgotPassModal'));
                myModal.show();

                //Show OTP box
                $(".otpbox").show();
                $(".otpbox input:first").focus();

                //Display success message
                $("#message").css("color", "green").text(data.message);

                //Hide password reset box until OTP is validated
                $("#passwordSet").hide();
                $("#passwordChangeBtns").hide();
            } else {
                bootbox.alert(data.message || "Failed to send OTP. Try again.");
            }
        },
        error: function (error) {
            bootbox.alert("Error: " + error.responseText);
        }
    });
}


</script>

<script>
function sendOtp() {
    const name = document.getElementById('name').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const otpInput = document.getElementById('otp');
    const submitOtpBtn = document.getElementById('submitOtpBtn');
    const sendOtpBtn = document.getElementById('sendOtpBtn');
    const timerDisplay = document.getElementById('timerDisplay');

    // Validate name and phone
    if (!name) {
        bootbox.alert('Please enter a name.');
        console.log('Validation failed: Name is empty');
        return;
    }
    if (!phone) {
        bootbox.alert('Please enter a phone number.');
        console.log('Validation failed: Phone is empty');
        return;
    }
    if (!/^[0-9]{10}$/.test(phone)) {
        bootbox.alert('Please enter a valid 10-digit phone number.');
        console.log('Validation failed: Invalid phone number');
        return;
    }

    // Enable OTP field and show Submit button
    otpInput.disabled = false;
    submitOtpBtn.classList.remove('hidden');
    sendOtpBtn.disabled = true;
    sendOtpBtn.classList.add('frezz');
    console.log('OTP input enabled, Submit button shown, Send OTP disabled.');

    // Start timer
    let timeLeft = 30;
    timerDisplay.textContent = `Submit OTP within ${timeLeft} seconds...`;
    console.log('Timer started:', timeLeft);

    const countdown = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = `Submit OTP within ${timeLeft} seconds...`;
        console.log('Timer tick:', timeLeft);

        if (timeLeft <= 0) {
            clearInterval(countdown);
            timerDisplay.textContent = 'OTP expired. Please request a new OTP.';
            otpInput.disabled = true;
            submitOtpBtn.classList.add('hidden');
            sendOtpBtn.disabled = false;
            sendOtpBtn.classList.remove('frezz');
            console.log('Timer expired.');
        }
    }, 1000);

    // Store countdown for clearing
    window.currentCountdown = countdown;
}

document.getElementById('otpVerificationForm').addEventListener('submit', function(event) {
    event.preventDefault();
    const otp = document.getElementById('otp').value.trim();
    const successMessage = document.getElementById('successMessage');
    const otpInput = document.getElementById('otp');
    const submitOtpBtn = document.getElementById('submitOtpBtn');
    const timerDisplay = document.getElementById('timerDisplay');

    // Validate OTP
    if (!otp) {
        bootbox.alert('Please enter the OTP.');
        console.log('Validation failed: OTP is empty');
        return;
    }
    if (!/^[0-9]{6}$/.test(otp)) {
        bootbox.alert('Please enter a valid 6-digit OTP.');
        console.log('Validation failed: Invalid OTP format');
        return;
    }
    if (otp !== '123456') {
        bootbox.alert('Invalid OTP. Please enter 123456.');
        console.log('Validation failed: OTP does not match 123456');
        return;
    }
    if (timerDisplay.textContent.includes('expired')) {
        bootbox.alert('OTP has expired. Please request a new OTP.');
        console.log('Validation failed: OTP has expired');
        return;
    }

    // Clear timer and show success
    clearInterval(window.currentCountdown);
    timerDisplay.textContent = '';
    successMessage.style.display = 'block';
    otpInput.disabled = true;
    submitOtpBtn.classList.add('hidden');
    console.log('OTP verified successfully.');

    // Redirect to /BamsRequisition/addBAMSRequisition after 2 seconds
//     setTimeout(() => {
//         successMessage.style.display = 'none';
//         console.log('Redirecting to /BamsRequisition/addBAMSRequisition');
//         window.location.href = '${contextPath}/BamsRequisition/addBAMSRequisition';
//     }, 2000);
});
</script>

