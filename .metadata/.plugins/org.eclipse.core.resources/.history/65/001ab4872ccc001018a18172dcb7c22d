<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib prefix = "fn" uri = "http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib uri = "http://java.sun.com/jsp/jstl/functions" prefix = "fn" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />


<section>
    <div class="mt-2">
        <form action="${contextPath}/procurement/quotation/quotationTracker" method="get" id="form" modelAttribute="quotationTracker">
            <div class="panel-body">
				<div class="row">
					<div class="col-md-12">
					<h5 class="mb-3">Quotation Tracker</h5>
						<div class="row">
<!-- 							<div class="col-md-3"> -->
<!-- 								<div class="form-group"> -->
<!-- 									<label class="col-md-12" for="text">Requisition Number</label> -->
<!-- 									<div class="col-md-12"> -->
<!-- 										<select class="form-control requiredField" name="requisitionId" id="requisitionId"> -->
<%-- 											<option value="0"><spring:message code="COMMON.SELECT" /></option> --%>
<%-- 											<c:forEach items="${lstReq}" var="req"> --%>
<%-- 												<option value="${req.requisitionId}" ${req.requisitionId eq requisitionId ? 'selected' : ''}>${req.requisitionNo}</option> --%>
<%-- 											</c:forEach> --%>
<!-- 										</select> -->
<!-- 									</div> -->
<!-- 								</div> -->
<!-- 							</div> -->
							<div class="col-md-3">
								<div class="form-group">
									<label class="col-md-12 required" for="text"><spring:message code="PROC.REQ.STATUS" /></label>
									<div class="col-md-12">
										<select class="form-control" id="status" name="status" >
											<option value="All" ${activeStatus eq 'All' ? 'selected' : ''}><spring:message code="COMMON.ALL" /></option>
<%-- 											<option value="DRAFT" ${activeStatus eq 'DRAFT' ? 'selected' : ''}><spring:message code="COMMON.DRAFT" /></option> --%>
											<option value="PENDING" ${activeStatus eq 'PENDING' ? 'selected' : ''}><spring:message code="COMMON.PRNDING" /></option>
											<option value="APPROVE" ${activeStatus eq 'APPROVE' ? 'selected' : ''}><spring:message code="COMMON.APPROVE" /></option>
											<option value="REVERT" ${activeStatus eq 'REVERT' ? 'selected' : ''}><spring:message code="COMMON.Revert" /></option>
											<option value="REJECT" ${activeStatus eq 'REJECT' ? 'selected' : ''}><spring:message code="COMMON.REJECT" /></option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-md-2 ">
								<input type="button" class="btn-submit" value="Submit" onclick="validateForms()">
								<a href="${contextPath}" class="btn-back">Cancel</a>
							</div>
<%-- 							<c:if test="${not empty requisitionId}"> --%>
<!-- 								<div class="col-md-7 btnholder" style="text-align: right;"> -->
<%-- 									<input type="button" class="btn btn-success" value="Quotation Comparison" onclick="quotationComparison(${requisitionId})">  --%>
<!-- 								</div> -->
<%-- 							</c:if> --%>
						</div>
<%-- 						<c:if test="${not empty lstReq}"> --%>
							<div class="row">
								<div class="col-md-12">
									<div class="table-responsive">
										<table class="datatable table table-striped table-bordered exportbtn mt-3">
											<thead>
												<tr>
													<th>Sl No</th>
													<th>Requisition No</th>
													<th>Rfq Quote No</th>
													<th>Vendor Name</th>
													<th>Currency</th>
													<th>Rfq Creation Date</th>
													<th>Rfq Quoted Date</th>
													<th>Status</th>
													<th>Action</th>
												</tr>
											</thead>
											<tbody>
												<c:forEach items="${lstQuote}" var="quote" varStatus="status">
													<tr>
														<td>${status.count}</td>
														<td>${quote.requisition.requisitionNo}</td>
														<td>${quote.quoteNo}</td>
														<td>${quote.vendor.vendorName}</td>
														<td>${quote.currency.currencyShortName}</td>
														<td><fmt:formatDate value='${quote.rfqCreationDate}' pattern='dd/MM/yyyy'/></td>
														<td><fmt:formatDate value="${quote.rfqQuotedDate}" pattern="dd/MM/yyyy"/> ${not empty quote.rfqQuotedDate ? '' :'*****'}</td>
														<td>${quote.stageForwardedRule.displayName}</td>
														<td>
															<a href="${contextPath}/procurement/quotation/viewRfqQuote?rfqQuoteId=${quote.rfqQuoteId}" class="btn button-alert btn-sm" data-toggle="tooltip" title="show quotation"><i class='fa-regular fa-eye'></i></a> 
														</td>
													</tr>
												</c:forEach>
											</tbody>
										</table>
									</div>
								</div>
							</div>
<%-- 						</c:if>						 --%>
					</div>
				</div>
			</div>
        </form>
	</div>
</section>
<form action="${contextPath}/procurement/quotation/quotationComparison" method="get" id="quotationComparison" modelAttribute="quotationComparison">
		<input type="hidden" id="reqId" name="requisitionId" value="">
</form>
<script>
	function validateForms() {
		var status=$("#status").val();
		$("#form").submit();
// 		if(status!=0){
			
// 		}else{
// 			alert("Please select status");
// 			return false;
// 		}
	}
	function quotationComparison(id) {
		$("#reqId").val(id);
		$("#quotationComparison").submit();
	}
</script>				