<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<script type="text/javascript" src="${contextPath}/assets/appJs/validation/common-utils.js"></script>

<style>
    .frezz {
        pointer-events: none;
        background-color: #e9ecef !important;
        color: #495057 !important;
    }
    .card-title-add {
        font-size: 14px;
        margin: 0;
        color: #000 !important;
        font-weight: 500;
    }
    .btns {
        border-radius: 0.2rem;
        line-height: 14px;
        padding: 6px 7px 6px 6px;
        font-size: 13px;
    }
    /* Ensure dropdown fits within sector */
    select.form-control-sm {
        max-width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>

<div class="breadcrumb_conatiner">
    <div class="col-md-6">
        <h4 class="change-color">PROGRESS REPORTS OF ITDA,CUMH,PSH</h4>
    </div>
    <div class="col-md-6">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="${contextPath}/home"><i class="fa fa-home"></i></a></li>
                <li class="breadcrumb-item active" aria-current="page">PROGRESS REPORTS OF ITDA,CUMH,PSH</li>
            </ol>
        </nav>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title">PROGRESS REPORTS OF ITDA,CUMH,PSH</h5>
    </div>
    <div class="card-body">
        <form class="form-horizontal" id="itdaProgressForm">
            <div class="row">
                <!-- From Date -->
                <div class="col-md-3 mb-3">
                    <label class="form-label required">From Date :</label>
                    <input type="date" class="form-control form-control-sm" id="fromDate" name="fromDate">
                </div>
                <!-- To Date -->
                <div class="col-md-3 mb-3">
                    <label class="form-label required">To Date :</label>
                    <input type="date" class="form-control form-control-sm" id="toDate" name="toDate">
                </div>
                <!-- Executing Agency -->
                <div class="col-md-3 mb-3">
                    <label class="form-label required">Name of Executing Agency ITDAs :</label>
                    <select class="form-control form-control-sm" id="executingAgency" name="executingAgency">
                        <option selected disabled>- Select -</option>
                        <option selected>ITDA, Kaptipada</option>
                    </select>
                </div>
                <!-- Project Name -->
                <div class="col-md-3 mb-3">
                    <label class="form-label required">Name of the Projects :</label>
                    <select class="form-control form-control-sm" id="projectName" name="projectName">
                        <option selected disabled>- Select -</option>
                        <option>Indira Gandhi Mahavidyalaya, Udala</option>
                        <option>Pedagadi Girls Hostel, Kaptipada</option>
                        <option>Dugdha UP School Hostel</option>
                        <option>Sudasudia PSH Hostel</option>
                        <option>Charusahi GP Boys Hostel</option>
                        <option>Dugudha Primary School Hostel</option>
                        <option>Jugal Kishore Hostel</option>
                        <option>Noto Panchayat Hostel</option>
                        <option>SVSN Guddiha Hostel, Silaghati</option>
                        <option>Dollipada UGHS Hostel</option>
                    </select>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-md-12 text-center">
                    <button type="button" class="btn btn-success" onclick="filterData()">Filter</button>
                    <a href="${contextPath}/home" type="button" class="btn btn-warning btn-sm">Back</a>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="card mt-4" id="expenditure-report">
    <div class="card-header">
        <h5 class="card-title">PROGRESS REPORTS OF ITDA,CUMH,PSH Details</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-bordered table-striped exportbtn" id="expenditureTable">
                <thead>
                    <tr>
                        <th>Sl.No.</th>
                        <th>Name of the executing agency ITDAs</th>
                        <th>Name of the District</th>
                        <th>Year of Sanctioned</th>
                        <th>Block</th>
                        <th>Scheme Name</th>
                        <th>Name of the projects</th>
                        <th>Agreement Amount (In Rs.)</th>
                        <th>Project approval Letter No. & Date</th>
                        <th>Funds released (1st phase) (In Rs.)</th>
                        <th>Sanction order / Date</th>
                        <th>Funds released (2nd phase) (In Rs.)</th>
                        <th>Sanction order / Date</th>
                        <th>Funds released (3rd phase) (In Rs.)</th>
                        <th>Sanction order / Date</th>
                        <th>Present status</th>
                        <th>UC Submitted</th>
                        <th>Date of completion</th>
                        <th>Remarks</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>CUMH</td>
                        <td>Indira Gandhi Mahavidyalaya, Udala (200 seated)</td>
                        <td>60,000,000</td>
                        <td>16323 dt.07.08.2023</td>
                        <td>60,000,000</td>
                        <td>17391 dt.21.08.2023</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>Just work started</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST/SC Girls hostel at Pedagadi Girls High School, Kaptipada</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>Completion Stage</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST Boys hostel at Dugdha Upper Primary High School</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>Ground floor lintel level</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 50 seated PSH hostel at Govt. UP, Sudasudia</td>
                        <td>15,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>3,750,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>11,250,000</td>
                        <td>928 dt.13.01.2025</td>
                        <td></td>
                        <td></td>
                        <td>Ground floor slab casting</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST/SC Boys hostel at Charusahi GP, High School</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>Completion Stage</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST Boys hostel at Dugudha Govt. Primary School</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>Completion Stage</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST Boys hostel at Jugal Kishore High School</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>Completion Stage</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST hostel at Noto Panchayat</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>Foundation Level</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST/SC Boys hostel at SVSN Guddiha, Silaghati High School</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>Completion Stage</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>ITDA, Kaptipada</td>
                        <td>Mayurbhanj</td>
                        <td>2023-24</td>
                        <td></td>
                        <td>Special ST Hostel</td>
                        <td>Const. of 120 seated ST hostel at Govt.UGHS Dollipada</td>
                        <td>30,000,000</td>
                        <td>25851 dt.13.11.2023</td>
                        <td>7,500,000</td>
                        <td>25945 dt.11.12.2023</td>
                        <td>12,300,000</td>
                        <td>12263 dt.27.05.2025</td>
                        <td></td>
                        <td></td>
                        <td>First floor roof level</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set default date range to last month
    const today = new Date();
    const lastMonth = new Date();
    lastMonth.setMonth(today.getMonth() - 1);

    // Format dates to YYYY-MM-DD
    const formatDate = (date) => {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    };

    document.getElementById('fromDate').value = formatDate(lastMonth);
    document.getElementById('toDate').value = formatDate(today);

    // Update filterData function to use new field IDs
    function filterData() {
        var fromDate = $("#fromDate").val();
        var toDate = $("#toDate").val();
        var executingAgency = $("#executingAgency").val();
        var projectName = $("#projectName").val();

        $('#hiddenStartDate').val(fromDate);
        $('#hiddenEndDate').val(toDate);
        $('#hiddenExecutingAgency').val(executingAgency);
        $('#hiddenProjectName').val(projectName);

        showLoader();

        var bizContent = $("#itdaProgressForm").serializeArray();
        $("#hiddenCipherText").val(enc_password(JSON.stringify(convertFormToJSONArray(bizContent))));
        $("#itdaProgressForm").submit();
    }
});
</script>