<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix = "fn" uri = "http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib uri = "http://java.sun.com/jsp/jstl/functions" prefix = "fn" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<c:set var="contextPath" value="${pageContext.request.contextPath}"/>
<script src="${contextPath}/resources/javascripts/accountMaster.js"></script>
<script src="${contextPath}/resources/javascripts/common.js"></script>
<script src="resources/javascripts/createAccountMaster.js"></script>
<style>
.table-striped>tbody>tr:nth-of-type(odd) {
    --bs-table-accent-bg: rgb(247 249 244) !important;
    /* color: var(--bs-table-striped-color); */
}
.accordion-body {
    padding: 0.5rem;
    background: #091a16 !important;
}
</style>


               
                  <div class="card">
<%--                   <%@ include file="/WEB-INF/views/message.jsp" %> --%>
               <div class="card-body" style="display:block">
								<p class="mandatory" align="right"><spring:message code="LAND.ALLOTMENT.MANDATORY"/></p>
								<div class="col-md-12">
									<form class="form-horizontal form-bordered"  id="createAccountMasterForm" >
                            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
							

								<div class="row">
									<div class="col-md-6 col-sm-6">
										<div class="form-group">
											<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
											<input type="hidden" name="accountId" id="accountId" value="${dto.accountId}">
											
											<c:if test="${not empty dto.subScheduleIds}">
												<c:forEach items="${dto.subScheduleIds}" var="subSch" varStatus="count">
													<input type="hidden" class="hdnSubSchIds" id="subsch${count.count}" value="${subSch}">
												</c:forEach>
											</c:if>
											
											<label class="col-md-12 " for="accountMasterName"><spring:message code="ACCOUNT.CREATEACCOUNTHEAD.ACCOUNTHEADNAME"/>:</label>
											<div class="col-md-12">
												<input type="text" name="accountName" class="form-control" id="accountMasterName" value="${dto.accountName}" maxlength="100" onblur="validateNameAndCode(this)">
											</div>
										</div>
									</div>
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12 required" for="accountMasterCode"><spring:message code="ACCOUNT.CREATEACCOUNTHEAD.ACCOUNTCODE"/>:</label>
											<div class="col-md-12">
												<input type="text" name="accountCode" class="form-control" id="accountMasterCode" value="${dto.accountCode}" maxlength="6" >
											</div>
										</div>
									</div>													
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12 required" for="accountType"><spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTCATEGORY" />:</label>
												<div class="col-md-12">
													<select class="form-select" name="accountType" id="accountType" onchange="showDiv(this);show(this)">
														 <option value=""><spring:message code="COMMON.LABEL.DROPDOWN.SELECT" /></option>
														<c:forEach items="${accountCategoryList}" var="accountCategory">
										                    <option value="${accountCategory.accountCategoryId}" ${dto.accountCategoryId eq accountCategory.accountCategoryId?'selected':'' }>${accountCategory.accountCategoryName}</option>
														</c:forEach>
													</select>
												</div>
											</div>
										</div>
									</div>
										
								<div class="row">
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12 required" for="accountGroup"><spring:message code="ACCOUNT.ACCOUNTMASTER.GROUP" />:</label>
											<div class="col-md-12">
												<select class="form-control" id="accountGroup" name="accountGroupId" data-plugin-selectTwo onchange="getAccountSubGroups(this.value,0);">
												<option value=""><spring:message code="COMMON.LABEL.DROPDOWN.SELECT" /></option>
													<c:forEach items="${parentActiveaccountGrupList}" var="parentActiveaccountGrup">
																<option value="${parentActiveaccountGrup.accountGroupId}" ${dto.accountCategoryId eq parentActiveaccountGrup.accountGroupId?'selected':'' }>${parentActiveaccountGrup.accountGroupCode} | ${parentActiveaccountGrup.accountGroupName}</option>
													</c:forEach>
												</select>
											</div>
										</div>
									</div>
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.ACCOUNTMASTER.SUBGROUP" />:</label>
											<div class="col-md-12">
												<select class="form-control" name="accountSubGroupId" data-plugin-selectTwo id="subAccountGroup">
													<option value=""><spring:message code="COMMON.LABEL.DROPDOWN.NONE" /></option>
											</select>
											</div>
										</div>
									</div>
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.ACCOUNTSCHEDULE.SCHEDULE" />:</label>
											<div class="col-md-12">
												<select class="form-select select2" multiple aria-label="Default select example" name="scheduleId" id="scheduleId" onchange="getSubSchedule();" >
													<option value=""><spring:message code="COMMON.LABEL.DROPDOWN.SELECT" /></option>
													 <c:forEach items="${scheduleActiveSubScheduleList}" var="scheduleSubSchedule">
														<option value="${scheduleSubSchedule.scheduleId}" 
														<c:forEach items="${dto.scheduleIds}" var="sch">${sch eq scheduleSubSchedule.scheduleId?'selected':''}</c:forEach>
														>${scheduleSubSchedule.scheduleCode} | ${scheduleSubSchedule.scheduleName}</option>
													</c:forEach>
												</select>
											</div>
										</div>
									</div>
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.ACCOUNTSCHEDULE.SUBSCHEDULE" />:</label>
											<div class="col-md-12">
												<select class="form-select select2" multiple aria-label="Default select example" name="subScheduleId" id="subScheduleId" >
													<option value=""><spring:message code="COMMON.LABEL.DROPDOWN.SELECT" /></option>
												</select>
												
											</div>
										</div>
									</div>
								</div>
											
							<div class="row">
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.COSTCENAPPLICABLE" /></label>
										<div class="col-md-12">
											<select class="form-control" name="costCenterApplicable" id="costCenterApplicable">
													<option value="N" ${dto.costCenterApplicable eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.costCenterApplicable eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.PARTYAPPLICABLE" /></label>
										<div class="col-md-12">
											<select class="form-control" name="partyApplicable" id="partyApplicable">
													<option value="N" ${dto.partyApplicable eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.partyApplicable eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.PROJECTAPPLICABLE" /></label>
										<div class="col-md-12">
											<select class="form-control" name="projectApplicable" id="projectApplicable">
													<option value="N" ${dto.projectApplicable eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.projectApplicable eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.WORKAPPLICABLE" /></label>
										<div class="col-md-12">
											<select class="form-control" name="workApplicable" id="workApplicable">
													<option value="N" ${dto.workApplicable eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.workApplicable eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.BUDGETAPPLICABLE" /></label>
										<div class="col-md-12">
											<select class="form-control" name="budgetApplicable" id="budgetApplicable">
													<option value="N" ${dto.budgetApplicable eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.budgetApplicable eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.DEPAPPLICABLE"/></label>
										<div class="col-md-12">
											<select class="form-control" name="depreciationApplicable" id="depreciationApplicable">
													<option value="N" ${dto.depreciationApplicable eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.depreciationApplicable eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>				
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="ACCOUNT.CREATEACCOUNTGROUP.ISVIRTUALACCOUNT"/></label>
										<div class="col-md-12">
											<select class="form-control" name="isVirtualAccount" id="isVirtualAccount">
													<option value="N" ${dto.isVirtualAccount eq 'N'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.NO"></spring:message></option>
													<option value="Y" ${dto.isVirtualAccount eq 'Y'?'selected':'' }><spring:message code="ACCOUNT.ACCOUNTMASTER.YES"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
								
							</div>
							
							<div class="row">
							  <c:if test="${not empty dto.accountId}">
								<div class="col-md-3 col-sm-3">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="COMMON.LABEL.STATUS" />:</label>
										<div class="col-md-12">
											<select class="form-control" name="status" id="status">
													<option value="ACTIVE" ${dto.isActive eq true?'selected':'' }><spring:message code="COMMON.LABEL.ACTIVE"></spring:message></option>
													<option value="INACTIVE" ${dto.isActive ne true?'selected':'' }><spring:message code="COMMON.LABEL.INACTIVE"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
							 </c:if>	
								<div class="col-md-2 col-sm-2">
									<div class="form-group">
										<label class="col-md-12 " for="inputDefault"><spring:message code="ACCOUNT.ACCOUNTHEAD.OPENINGBALANCEL"/>:</label>
										<div class="col-md-12">
											<c:choose>
												<c:when test="${empty accountMasterListById.openingBalance}">
													<c:set var="openingBal" value="0.00" />
												</c:when>
												<c:otherwise>
													<c:set var="openingBal" value="${dto.openingBalance}" />
												</c:otherwise>
											</c:choose>
											<input type="text" name="openingBalance" class="form-control" id="openingBalance" style="text-align: right" placeholder="0.00" value="${openingBal}" maxlength="20" onchange ="validateDecimalField('openingBalance','2','20','opening balance'),validateNonNegativeField('openingBalance', 'opening balance');">
										</div>
									</div>
								</div>
								<div class="col-md-1 col-sm-1">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="LABEL.BANKPAYMENT.DRCR" />:</label>
										<div class="col-md-12">
											<select class="form-control" name="openingBalanceDrCr" id="openingBalanceDrCr">
													<option value="Dr" ${dto.openingBalanceDrCr eq 'Dr'?'selected':'' }><spring:message code="ACCOUNT.VOUCHER.ACCOUNT.DR"></spring:message></option>
													<option value="Cr" ${dto.openingBalanceDrCr eq 'Cr'?'selected':'' }><spring:message code="ACCOUNT.VOUCHER.ACCOUNT.CR"></spring:message></option>
											</select>
										</div>
									</div>
								</div>
							</div>
							<div class="row">	
								<div id="bankDiv" style="display:none" >
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12 " for="inputDefault"><spring:message code="LABEL.PARTYDETAILS.BANKNAME"/>:</label>
											<div class="col-md-12">
												<select class="form-control" name="bankMaster.bankId" id="bankName" data-plugin-selectTwo onchange="getBankBranchList();" >
							                        <option value=""><spring:message code="COMMON.LABEL.DROPDOWN.SELECT"/></option>
							                        	<c:forEach items="${bankList}" var="bank">
						                        			<option value="${bank.bankId}" ${dto.branchNameId.bankId eq bank.bankId?'selected':'' }>${bank.bankName} (${bank.bankCode})</option>
							                             </c:forEach>
							                 	</select>
											</div>
										</div>
									</div>
								 
									 <div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12" for="inputDefault"><spring:message code="LABEL.PARTYDETAILS.BANKBRANCH"/>:</label>
											<div class="col-md-12">
											  	<textarea class="form-control" name="bankBranchName" id="Bankbranchname" style="height: 28px;" maxlength="70">${dto.branchNameId.branchName}</textarea>
											</div>
										</div>
									</div> 
									<div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12 " for="inputDefault"><spring:message code="LABEL.PARTYDETAILS.BANKACNO"/>:</label>
											<div class="col-md-12">
												<input type="text" class="form-control" name="bankAccountNo" maxlength="20" id="bankAcNo" value="${dto.bankAccountNumber}" onkeypress="return isNumber(event)" >
											</div>
										</div>
									</div>
								</div>
							</div>
							
							<div class="row">		
								<div class="col-md-6 col-sm-6">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="COMMON.LABEL.DESCRIPTION"/>:</label>
										<div class="col-md-12">
											<textarea  name=description class="form-control" id="description" style="height: 28px;" maxlength="200" >${dto.description}</textarea>
										</div>
									</div>
								</div>
								<div class="col-md-6 col-sm-6">
									<div class="form-group">
										<label class="col-md-12" for="inputDefault"><spring:message code="COMMON.LABEL.ACCOUNTNARRATION"/>:</label>
										<div class="col-md-12">
											<textarea  name=accountNarration class="form-control" id="accountnarration" style="height: 28px;" maxlength="200" >${dto.accountNarration}</textarea>
										</div>
									</div>
								</div>
								
								 <div class="col-md-3 col-sm-3">
										<div class="form-group">
											<label class="col-md-12" for="inputDefault">Accural Ledger Code :</label>
											<div class="col-md-12">
												<select class="form-control" name="accquralAccountCode" data-plugin-selectTwo  id="accquralAccountCode">
													<option value=""><spring:message code="COMMON.LABEL.DROPDOWN.SELECT" /></option>
													<c:forEach items="${accquralActiveaccountList}" var="accquralAccountCodeList">
															<option value="${accquralAccountCodeList.accountCode}" ${dto.accquralAccountCode eq accquralAccountCodeList.accountCode?'selected':'' }>${accquralAccountCodeList.accountCode} | ${accquralAccountCodeList.accountName}</option>
													</c:forEach>
												</select>
											</div>
										</div>
									</div> 
								
							</div>
							<div class="row">
								<div class="col-sm-12" style="margin-top:30px;">
									<div class="form-group text-center">
										<button type="button" class="btn btn-success" onclick="checkFormData_onSubmit('createAccountMasterForm');" ><spring:message code="COMMON.BUTTON.SAVE"></spring:message></button>
										<a href="${contextPath}/home" ><input type="button" class="btn btn-danger" value=<spring:message code="COMMON.BUTTON.BACK"></spring:message>></a>
									</div>
								</div>
							</div>
						</form>
					</div>
				</div>
          </div>
        
        
        <div class="main-content mt-3">
    <div class="row">
          <div class="col-lg-12">
            <div class="accordion" id="accordionExample1">
            <div class="panel-actions">
						<c:choose>
								<c:when test="${not empty dto.accountId}">
<!-- 									<a href="#" class="fa fa-caret-up"></a> -->
									<c:set var="sectionHead" value="none"></c:set>
								</c:when>
								<c:when test="${empty dto.accountId}">
<!-- 									<a href="#" class="fa fa-caret-down"></a> -->
									<c:set var="sectionHead" value="block"></c:set>
								</c:when>
							</c:choose>
					</div>
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingtwo">
                  <button class="accordion-button" type="button"
		                    data-bs-toggle="collapse" data-bs-target="#collapseTwo"
		                    aria-expanded="true" aria-controls="collapseTwo">
		                   <spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTMASTERLIST"/>
                  </button>
                 
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse show"
                  aria-labelledby="headingtwo"
                  data-bs-parent="#accordionExample1">
                  <div class="accordion-body">
<%--                   <%@ include file="/WEB-INF/views/message.jsp" %> --%>
               <div class="panel-body" style="display:block">
					<div class="col-md-12">
						<form id="editAccountMaster" action="${contextPath}/generalledger.htm" method="post">
								<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
								<table class="table table-bordered mb-none" id="datatable-default">
									<thead>
										<tr>
											<th class="width42Percent"><spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTHEADNAME"/></th>
											<th class="width10Percent"><spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTHEADCODE"/></th>
											<th class="width17Percent"><spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTGROUP"/></th>
											<th class="width11Percent"><spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTTYPE"/></th>
											<%-- <th><spring:message code="ACCOUNT.ACCOUNTHEAD.ACCOUNTCATEGORY"/></th> --%>
											<th class="width10Percent"><spring:message code="COMMON.LABEL.STATUS"/></th>
											<th class="width10Percent"><spring:message code="COMMON.LABEL.OPTION"/></th>
										</tr>
									</thead>
									<tbody>
										<c:forEach items="${accountMasterList}" var="accountMaster">								
											<tr class="gradeX">
												<td>${accountMaster.accountName}</td>
												<td>${accountMaster.accountCode}</td>
												<td>${accountMaster.accountGroup.accountGroupName}</td>
												<td>${accountMaster.accountType}</td>
												<c:if test="${accountMaster.isActive eq true}">
												 <td>ACTIVE</td>
												</c:if>
												<c:if test="${accountMaster.isActive ne true}">
												 <td>INACTIVE</td>
												</c:if>
												<td>
											 	<input type="hidden" name="accountId" id="account_ids">
													<a class="btn btn-sm text-white btn-circle btn-warning" title = <spring:message code="COMMON.BUTTON.ICONEDIT"/> onclick="edit('${accountMaster.accountId}')">
													<i class="fa fa-pencil" aria-hidden="true"></i></a> 
												</td> 
											</tr> 
										</c:forEach>	
									</tbody>
								</table>
							</form>
					</div>
				</div>
          </div>
        </div>
      </div>
    </div>
    </div>
    </div>
    <form action="${contextPath}/mst/createaccounledgermaster.htm" method="POST" id="finalSubmit">
	    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
	    <input type="hidden" name="encData" id="hdnData"/>
	     <input type="hidden" name="hdnScheduleIds" id="hdnScheduleIds"/>
	      <input type="hidden" name="hdnSubScheduleIds" id="hdnSubScheduleIds"/>
    </form>
     <form action="${contextPath}/mst/editAccountLedgerMaster" method="POST" id="editForm">
	    <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
	    <input type="hidden" name="hdnAccountId" id="hdnAccountId"/>
    </form>
        </div>
    </section>

	<script>
    document.getElementById('accountMasterCode').addEventListener('input', function (e) {
        var value = e.target.value;
        var sanitizedValue = value.replace(/\D/g, '');
        if (value !== sanitizedValue) {
            e.target.value = sanitizedValue;
        }
    });
    
    
    $(document).ready(function() {
    	 var groupId='${dto.accountGroupId}';
    	  var subGroup='${dto.accountSubGroupId}';
    	  if(groupId!=''){
    		 getAccountSubGroups(groupId,subGroup);
    	  }
    	
    	var val = '${not empty dto.scheduleIds}';
    	if(val=='true'){
    		getSubSchedule();
    	}   	
    });
    
    
    const checkFormData_onSubmit = async (formId) => {
    	debugger
        const requiredFields = document.querySelectorAll('.required');
        let validationFailed = false;

        for (const field of requiredFields) {
            const inputId = field.getAttribute('for');
            const inputField = document.getElementById(inputId);
            if (!inputField.value) {
                inputField.style.borderColor = 'red';
                await showNotification(true, field.textContent.replace(/:/g, "") + " is required.");
                setTimeout(() => {
                    inputField.style.borderColor = '';
                }, 3000);
                validationFailed = true;
                break;
            }
        }
    	
        if (!validationFailed) {
			   	 const scheduleId = Array.from(document.getElementById('scheduleId').selectedOptions).map(option => option.value);
			   	 const subScheduleId = Array.from(document.getElementById('subScheduleId').selectedOptions).map(option => option.value);
			   	    
			   	$("#hdnScheduleIds").val(AES256.encrypt(JSON.stringify(scheduleId)));
			   	$("#hdnSubScheduleIds").val(AES256.encrypt(JSON.stringify(subScheduleId)));
			   	
			   	const encryptFormDataResult = await encryptHiddenFormData('createAccountMasterForm');
			       if (encryptFormDataResult) {
			           $('#hdnData').val(encryptFormDataResult);
			           $('#finalSubmit').submit();
			       } else {
			           showNotification(true, 'Unable to process your request. Please try after some time.');
			       }
        }     
        return false;
    }
    
    function validateNameAndCode(element)
    {
    	var result = element.value.replace(/[\u005F\u003D\u200B-\u200D\u201A-\u201E\u2013-\u2122\uFEFF\!@#$^&*+<>\\\/|\?~{}())(\:%]/g,'');
    	element.value =result;
    }
    
    
    function showDiv(select){
    	   if(select.value == "Bank"){
    	    document.getElementById('bankDiv').style.display = "block";
    	    document.getElementById('office').style.display = "block";
    	   }else if(select.value == "Cash"){
    		   document.getElementById('office').style.display = "block";
    		   document.getElementById('bankDiv').style.display = "none";
    	   }else{
    	   
    	    document.getElementById('bankDiv').style.display = "none";
    	    document.getElementById('office').style.display = "none";
    	   }
    	}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
    
    function getAccountSubGroups(groupId,selectedSubGrp){
        debugger
        $.ajax({
            type: "GET",
            url: '${contextPath}/mst/getAccountSubGroups',
            data: {
                "accountId": AES256.encrypt(groupId), 
            },
            success: function(response) {
                var subScheduleDropdown = $('#subAccountGroup');
                subScheduleDropdown.empty();
                $.each(JSON.parse(response), function(index, value) { 
                    subScheduleDropdown.append($('<option>', {
                        value: value.accountGroupId, 
                        text: value.accountGroupCode + ' | ' + value.accountGroupName 
                    }));
                });
                
                if(selectedSubGrp!=''){
                	$("#subAccountGroup").val(selectedSubGrp);
                }
            },
            error: function(xhr, status, error) {
                console.error("Error occurred: " + status + " " + error);
            }
        });
    }



    function getSubSchedule(){
    	debugger
        var selectedScheduleIds = $('#scheduleId').val();
        if (selectedScheduleIds.length > 0) {
            $.ajax({
                type: "GET",
                url: '${contextPath}/mst/getSubSchedules',
                data: {
                    "scheduleIds":AES256.encrypt(JSON.stringify(selectedScheduleIds)),
                },
                contentType: "application/json; charset=utf-8",
                success: function(response) {
                    var subScheduleDropdown = $('#subScheduleId');
                    subScheduleDropdown.empty();
                    $.each(response, function(index, subSchedule) {
                        subScheduleDropdown.append($('<option>', {
                            value: subSchedule.scheduleId,
                            text: subSchedule.scheduleCode + ' | ' + subSchedule.scheduleName
                        }));
                    });
                    
                    debugger
                    	var result = '${not empty dto.subScheduleIds}';
                    	if(result=='true'){
                    		var values = $(".hdnSubSchIds");
                    		var preSelectedSubScheduleIds=[];
                    		 $.each(values, function(index, elem) {
                    			 preSelectedSubScheduleIds.push(elem.value);
                             });
                    		 if(preSelectedSubScheduleIds.length > 0){
                    			 subScheduleDropdown.val(preSelectedSubScheduleIds).trigger('change');
                    		 }
                    	}
                },
                error: function(xhr, status, error) {
                    console.error("Error occurred: " + status + " " + error);
                }
            });
        }
    }


    function getBankBranchList()
    {
    	var bankId = $('#bankName').val();
    	var trHTML='<option value="">' +labelDropdownTextSelect+ '</option>';
    	$.ajax({
    		url : './getBankBranchList.htm',
    		type:'GET',
    		data : ({
    				bankId : $('#bankName').val()
    			}),
    		cache:false,
    		asynch:false,
    		success : function(response) 
    		{
    			if(response !="")
    			{
    				var obj=jQuery.parseJSON(response);		
    				$.each(obj, function(i, value) 
    				{
    					trHTML +='<option value="'+value.id+'">'+value.branchName+'</option>';
    				}); 
    				$('#bankBranchId').empty().append(trHTML); 
    			}
    			else
    			{
    				$('#bankBranchId').empty().append(trHTML); 
    			}
    		},
    		error:function(transport)
    		{
    			$('#bankBranchId').empty().append(trHTML); 
    		}
    		
    	});
    	
    }
    
     function edit(accountId){
    	debugger
    	$("#hdnAccountId").val(AES256.encrypt(accountId));
	    $('#editForm').submit();
    }
    
</script>
								
		