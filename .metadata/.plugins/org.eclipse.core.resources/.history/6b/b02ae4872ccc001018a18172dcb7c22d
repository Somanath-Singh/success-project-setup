<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>IPMS Management</title>
		<meta content='width=device-width, initial-scale=1.0, shrink-to-fit=no' name='viewport' />
		<meta name="keywords" content="HMS" />
		<meta name="description" content="HMS">
		<meta name="author" content="Aashdit Technologies">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
		<c:set var="contextPath" value="${pageContext.request.contextPath}" />
		<meta http-equiv="cache-control" content="max-age=0" />
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="cache-control" content="no-store" />
		<meta http-equiv="cache-control" content="pre-check=0" />
		<meta http-equiv="cache-control" content="post-check=0" />
		<meta http-equiv="cache-control" content="must-revalidate" />
		<meta http-equiv="expires" content="0" />
		<meta http-equiv="pragma" content="no-cache" />
		<link rel="shortcut icon" href="${contextPath}/assets/img/favicon.png">
		<!-- Fonts and icons -->
		<link href="${contextPath}/assets/css/bootstrap.min.css" rel="stylesheet" />
		<link href="${contextPath}/assets/css/datatables.min.css" rel="stylesheet" />
		<link href="${contextPath}/assets/css/bootstrap-select.min.css" rel="stylesheet" />
		<link href="${contextPath}/assets/vendor/select2full/select2.min.css" rel="stylesheet" />
		<link href="${contextPath}/assets/vendor/jquery_datepicker/jquery.datepick.css" rel="stylesheet" />
<%-- 		<link href="${contextPath}/assets/css/style.css" rel="stylesheet" /> --%>
		<link href="${contextPath}/assets/vendor/fontawesome-free-web/css/all.min.css" rel="stylesheet">
		
		<link href="${contextPath}/assets/css/main.css" rel="stylesheet" />
		<link href="${contextPath}/assets/css/hims-theme.css" rel="stylesheet" />
		<link href="${contextPath}/assets/css/responsive.css" rel="stylesheet" />
		
		<%-- <link rel="stylesheet" href="${contextPath}/assets/vendor/bootstrap-multiselect/bootstrap-multiselect.css" /> --%>
		
	    <script src="${contextPath}/assets/js/jquery.min.js"></script>
	    <script src="${contextPath}/assets/js/ckeditor.js"></script>
		<style>
            #chartdiv {
                width: 100%;
                height: 500px;
            }
			header {			
				/*background:linear-gradient(21deg, #0a3e1d 7.42%, #60833c 91.76%) !important;*/
				background:url(${contextPath}/assets/img/bg.jpg);
			
		}
		#messageDiv button {
		    font-size: 15px;
		    font-weight: 600;
		}
		.dataTables_info{
		font-size:12px
		}
		
		</style>
		
		
		
		<script>
			window.ctxPath='${contextPath}'; 
		</script>
		<script type="text/javascript">
	  		window.contextPath = '${contextPath}'; 
			$(function() 
			{
			       var url = window.location.href;
			       var newurl = url.split('?');
			       var finala=newurl[0];
			       $(".nav-primary a").each(function() 
			       {
			              if (finala == this.href)
			              {
			                     $(this).parent().addClass("active");
			                     $(this).parent().parent().parent().addClass("show");
			                     $(this).parent().parent().parent().parent().addClass("active");
			                     $(this).parent().parent().parent().parent().parent().parent().addClass("show");
			              }
			       });
			});
		</script>
		
		  <script>
		    function showLoader() {
		      // add css display flex in loader-div class
		        $(".loader-div").css("display", "flex");
		
		    }
		    function hideLoader() {
		      $(".loader-div").css("display", "none");
		    }
		  </script>
	</head>
	
	
<body class="body">
      <div class="wrapper">
        <section class="body_bg">
          <div class="jumbo absolute -inset-[10px] opacity-50"></div>
        </section>
        
        
		<tiles:insertAttribute name="header" />
		
			<tiles:insertAttribute name="menu" />			
		
			<section class="main-panel">
			<div class="content">
			<tiles:insertAttribute name="body">
				<jsp:include page="/WEB-INF/views/message.jsp"></jsp:include>
			</tiles:insertAttribute>	
			</div>
			</section>
		</div>

		<!-- Page Specific Scripts -->
		<tiles:insertAttribute name="pageScripts" />	
	
		
		<script src="${contextPath}/assets/vendor/jquery_datepicker/jquery.plugin.js"></script>
		<script src="${contextPath}/assets/vendor/jquery_datepicker/jquery.datepick.min.js"></script>
		
		<script src="${contextPath}/assets/js/bootstrap.bundle.min.js"></script>
		<%-- <script src ="${contextPath}/assets/bootstrap/js/popper.js"></script>  --%>
		
		<script src="${contextPath}/assets/vendor/bootbox5/bootbox.all.min.js"></script>
		<script src="${contextPath}/assets/js/bootstrap-select.min.js"></script>
		<%-- <script src="${contextPath}/assets/vendor/bootstrap-multiselect/bootstrap-multiselect.js"></script> --%>
		
	<script src="${contextPath}/assets/charts/core.js"></script>
	<script src="${contextPath}/assets/charts/charts.js"></script>
	<script src="${contextPath}/assets/charts/animated.js"></script>

	<script src="${contextPath}/assets/charts/activitychart.js"></script>
	<script src="${contextPath}/assets/charts/financialanalaysis.js"></script>
	<script src="${contextPath}/assets/charts/profitandlosss.js"></script>
	<script src="${contextPath}/assets/charts/beneficiarychart.js"></script>
	<script src="${contextPath}/assets/charts/expenditurechart.js"></script>
	<script src="${contextPath}/assets/charts/spvchart.js"></script>
	
	<script src="${pageContext.request.contextPath}/assets/applicationSpecific/encrypt/AesUtil.js"></script>
	<script src="${pageContext.request.contextPath}/assets/applicationSpecific/encrypt/aes.js"></script>
	<script src="${pageContext.request.contextPath}/assets/applicationSpecific/encrypt/pbkdf2.js"></script>
	<script src="${pageContext.request.contextPath}/assets/applicationSpecific/encrypt/lbase.js"></script>
	
        
  
        
        
        
        
	
	<!-- jQuery Scrollbar -->
	<script src="${contextPath}/assets/vendor/select2full/select2.full.js"></script>
	<%-- <script src="${contextPath}/assets/vendor/jquery_datepicker/jquery.plugin.js"></script>
	<script src="${contextPath}/assets/vendor/jquery_datepicker/jquery.datepick.js"></script> --%>
	<script src="${contextPath}/assets/js/datatables.min.js"></script>
	<script src="${contextPath}/assets/js/main.js"></script>
	

		<script>
		 $(document).ready(function() {
	            $('.exportbtn').DataTable({
	                dom: 'lBfrtip',
	                responsive: true,
	                pageLength: 10,
	                 lengthMenu: [0, 5, 10, 20, 50, 100, 200, 500],

	                buttons: [
	                    'copy', 'excel', 'pdf'
	                ]

	            });
	        });
		 
		 
            /*  $(function () {
                $(".datepicker").datepicker({
                    changeMonth: true,
                    changeYear: true,
                    showButtonPanel: true,
                });
                
            });  */
        </script>
        
        
<script>
$(function () {
	$('.datepicker').datepick({
		onShow: $.datepick.monthOnly, dateFormat: 'dd/mm/yyyy', yearRange: 'c-100:c+5', showOnFocus: true,
		showTrigger: '<button type="button" class="trigger">' +
			'<i class="fa fa-calendar"></i></button>'
	});
});
$(function () {
    // Function to convert dd-mm-yyyy to a JavaScript Date object
    function parseDate(dateStr) {
        var parts = dateStr.split('-'); // Split the string by '-'
        var day = parseInt(parts[0], 10); // Day part
        var month = parseInt(parts[1], 10) - 1; // Month part (0-based)
        var year = parseInt(parts[2], 10); // Year part
        return new Date(year, month, day); // Create Date object
    }

    // Initialize the datepicker
    $('.datepicker1').datepick({
        onShow: $.datepick.monthOnly, // Month-only view
        dateFormat: 'dd-mm-yyyy', // Date format
        yearRange: 'c-100:c+5', // Year range
        showOnFocus: true, // Show on focus
        showTrigger: '<button type="button" class="trigger">' +
            '<i class="fa fa-calendar"></i></button>', // Trigger button
        minDate: parseDate('25-12-2024'), // Convert dd-mm-yyyy to Date object
        onSelect: function(dates) {
            // Get the selected date
            var selectedDate = dates[0]; // First selected date

            // Dynamically update the minimum date
            $('.datepicker1').datepick('option', { minDate: selectedDate });

            // Log for debugging
            console.log('New minDate:', selectedDate);
        }
    });
});



$(function () {
    $('.datepicker2').datepick({
        onShow: $.datepick.monthOnly,
        dateFormat: 'dd/mm/yyyy',
        yearRange: 'c-100:c+5',
        showOnFocus: true,
        showTrigger: '<button type="button" class="trigger">' +
            '<i class="fa fa-calendar"></i></button>'
    });
});


function convertDateFormat(dateString) {
    const parts = dateString.split('/');
    if (parts.length === 3) {
        const dd = parts[0];
        const mm = parts[1];
        const yyyy = parts[2];
		const finalDate= yyyy+"-"+mm+"-"+dd;
        return finalDate ;
    }
    return null; 
}


		</script>
		
		 <script>
		 /* $(document).ready(function() {
		        $('.multiselect').multiselect();
		    }); */
        </script>
        	<form method="post" action="${contextPath}/umt/logout" id="frmLogout">
		<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
		<input type="submit" style="display: none" />
	</form>
	<script>
    var timeout;

    function startTimeout() {
        timeout = setTimeout(logout, 1500000); // 25 minutes timeout
    }

    function resetTimeout() {
        clearTimeout(timeout);
        startTimeout();
    }

    function logout() {
        
   		bootbox.confirm({
	        title : "<span style='color:red;'>USER ALERT !!</span>",
	        message : "<span style='color:red;'>Your page has been in standby mode for a long time. Kindly refresh it else your login session will be timed out.</span>" ,
	        buttons : {
	            confirm : {label: "Login", className: "btn btn-sm btn-success"},
	            cancel : {label: "Refresh", className: "btn btn-sm btn-primary"}
	        },
	        callback: function(result){
	        	if (result){
	        		$("#frmLogout").submit();
	        		showLoader();
				}else{
					 location.reload();
				}
	        }
		});
    }

    // Start the timeout when the page is loaded
    window.onload = resetTimeout;

    // Reset the timeout whenever there is user activity (e.g., mousemove, keydown)
    document.onmousemove = resetTimeout;
    document.onkeydown = resetTimeout;
</script>
        
        <script>
    function convertFormToJSONArray(form) {
        const array = form;
        const json = {};
        $.each(array, function() {
            var contentCheck = this.name;
            if (json[this.name]) {
                if (!json[this.name].push) {
                    json[this.name] = [json[this.name]];
                }
                json[this.name].push(this.value || '');
            } else if (contentCheck.includes("Array")) {
                json[this.name] = [this.value];
            } else {
                json[this.name] = this.value || '';
            }
        });
        return json;
    }
</script>

<script>

$(document).ready(function() {
	 $('.select2').select2();
	 });
</script>

<script type="text/javascript">
	const selectAll = document.querySelectorAll('.form-select')
	selectAll.forEach((i)=>{
		if(!i.multiple){
			i.classList.add('select2')
		}
	})
	
</script>
        
	
	</body>
</html>