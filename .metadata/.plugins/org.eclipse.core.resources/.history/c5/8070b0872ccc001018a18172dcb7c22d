<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<c:set var="contextPath" value="${pageContext.request.contextPath}" />
<style>
.checkGrid{
	display: flex;
    align-items: center;
    margin-top: 17px;
    border: 1px solid #dbdee8;
    border-radius: 4px;
    justify-content: space-around;
    background: #e7eaf2;
    height: 34px;
}
</style>
<div class="breadcrumb_conatiner">
	<div class="col-md-6">
		<h4 class="change-color">UOM</h4>
	</div>
	<div class="col-md-6">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="${contextPath}/home"><i class="fa fa-home"></i></a></li>
				<li class="breadcrumb-item">
                  <a href="#">Procurement</a>
                </li>
				<li class="breadcrumb-item active" aria-current="page">UOM</li>
			</ol>
		</nav>
	</div>
</div>

<div class="row">
	<div class="col-md-12">

		<div class="card">
			<div class="card-header">
				<h5 class="card-title">UOM</h5>
			</div>
			<div class="card-body">
				<form method="POST"
					action="${contextPath}/assetflow/master/uom/save" id="addUomFrm">
					<input type="hidden" name="${_csrf.parameterName}"
						value="${_csrf.token}" /> <input type="hidden" id="uomId"
						name="uomId" value="${uom.uomId }"> <input type="hidden"
						class="" id="encodedDataaddUomFrm" name="encodedDataFrm" value="" />
					<div class="row">
						<div class="col-md-12">
							<div class="row">
								<div class="form-group col-md-3">
									<label class="col-md-12 required" for="text">UOM Name :</label>
									<input class="form-control form-control-sm noSpecialChar"
										type="text" id="uom" name="uom" placeholder="Enter UOM name"
										value="${uom.uom }" maxlength="30">
								</div>
								<div class="form-group col-md-3">
									<label class="col-md-12 " for="text">UOM Code :</label> <input
										class="form-control form-control-sm" type="text"
										name="uomCode" id="uomCode" placeholder="UOM code"
										value="${uom.uomCode }" maxlength="30" readonly>
								</div>
								<div class="form-group col-md-2 checkGrid">
									
									<label class="m-0" for="checkbox" >Is Fractional:</label>
									<input type="checkbox" name="isFractional" id="isFractional"
										onclick="checkMark(this)"
										value="${uom.isFractional ? true : false }"
										${uom.isFractional ? 'checked' : '' }>
								</div>

								<c:if test="${not empty uom.uomId }">
									<div class="form-group col-md-2 toggleTrueFalse" data-label-on="True" data-label-off="False" data-toggle-width="90" style="margin-left: 15px;margin-top: 20px !important;">
										<input type="checkbox" value="${uom.isActive}" class="toggleCheckBox" ${uom.isActive == 'true' ? 'checked' : ''} id="parametros_MOSTRAPEDIDOS" name="isActive" /> 
										<label class="clickToggle" for="parametros_MOSTRAPEDIDOS"></label>
									</div>
								</c:if>

								<div class="col-md-12 btn-div d-flex align-items-center gap-2">
									<input type="button" class="btn btn-success" value="${not empty uom.uomId  ? 'Update' : 'Save' }" onclick="validateForms()">
										<a type="button" class="btn btn-sm btn-danger" onclick="backToModule()">Cancel</a>
									<c:if test="${not empty uom.uomId  }">
										<a type="button"
											href="${contextPath}/assetflow/master/uom/add"
											class="btn btn-submit">Add New</a>
									</c:if>
								</div>
							</div>
						</div>
					</div>
				</form>

			</div>
		</div>
		<div class="col-md-12 mt-3">
			<div class="card">
				<div class="card-header">
					<h5 class="card-title">UOM List</h5>
				</div>
				<div class="card-body">
					<div class="table-responsive">
						<table
							class="datatable table table-striped table-bordered exportbtn mt-3">
							<thead>
								<tr>
									<th>Sl No</th>
									<th>UOM Name</th>
									<th>UOM Code</th>
									<th>Is Fractional</th>
									<th>Active/InActive</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								<c:forEach items="${uomList}" var="uomm" varStatus="status">
									<tr>
										<td>${status.count}</td>
										<td>${uomm.uom}</td>
										<td>${uomm.uomCode}</td>
										<td><c:choose>
												<c:when test="${uomm.isFractional}">
										Yes
									</c:when>
												<c:otherwise>
										No
									</c:otherwise>
											</c:choose></td>
										<td>
											<div class="form-group col-md-2 mt-0 mb-0 toggleTrueFalse"
												data-label-on="True" data-label-off="False"
												data-toggle-width="90">
												<input type="checkbox" value="${uomm.isActive}"
													class="toggleCheckBox"
													${uomm.isActive == 'true' ? 'checked' : ''}
													id="parametros_MOSTRAPEDIDOS" name="isActive" disabled /> <label
													class="clickToggle" for="parametros_MOSTRAPEDIDOS"></label>
											</div>
										</td>
										<td><a href="#" onclick="edit(${uomm.uomId})"
											class="btn btn-primary" data-toggle="tooltip"
											title="Edit itemType"><i class='fa fa-pencil'></i></a></td>
									</tr>
								</c:forEach>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<form method="get" action="${contextPath}/assetflow/master/uom/add"
	id="edit">
	<input type="hidden" id="uomIddd" name="uomId" value=""> <input
		type="hidden" class="" id="encodedDataedit" name="encodedDataedit"
		value="" />
</form>
<form method="post" action="${contextPath}/assetflow/master/uom/delete"
	id="deleteUom">
	<input type="hidden" name="${_csrf.parameterName}"
		value="${_csrf.token}" /> <input type="hidden" id="uomIdd"
		name="uomId" value="">
</form>
<script>
function backToModule(){
       let currentModuleCode =  localStorage.getItem('currentModuleCode');
       $('#moduleId').val(enc_password(currentModuleCode));
       $('#moduleForm').submit();
    }
    function checkMark(that){
        if(that.checked) {
            that.value=true;
        }else{
            that.value=false;
        }
    }
    function edit(id){
        $("#uomIddd").val(id);
        encryptFormData("edit", tableOrTbodyIDS, tableOrTbodyKeys);
        $("#edit").submit();
    }
	function validateForms(){
		var uomName=$("#uom").val().trim();
		if(uomName==""){
			displayErrorMsg("uom", "Please Enter UOM Name")
			return false;
		}else{
			clearError("uom");
		}
		var msg="Are you sure you want to "+${not empty uom.uomId  ? '"Update"' : '"Save"' }+"?";
		bootbox.confirm({
			message: msg,
			buttons: {
				confirm: {
					label: 'Yes',
					className: 'btn-success'
				},
				cancel: {
					label: 'No',
					className: 'btn-danger'
				}
			},
			callback: function (result) {
				if(result){
				    encryptFormData("addUomFrm", tableOrTbodyIDS, tableOrTbodyKeys);
					$("#addUomFrm").submit();
				}
			}
		});
		
	}
	function deleteUom(id){
		$("#uomIdd").val(id);
		$("#deleteUom").submit();
	}
</script>